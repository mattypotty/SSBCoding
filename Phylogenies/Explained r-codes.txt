####################################################################################################################
##############################An explained version of the new functions used in the analyses########################
####################################################################################################################


####################################################################################################################
##############################Merging seperate trees for instance a genus and a family tree#########################
####################################################################################################################
#The higher order tree (e.g. the family tree is called PHYLO), and the function creates a new tree also called PHYLO. 
#The input to the function is a specified lower order tree "Lower.Phyl" as well as a list of the taxa which are expected to be monophyletic in the higher order tree.
#This function will often create multiple copies of the following warning which can be ignored
#warning "In min(unlist(ANC.list[i])[unlist(ANC.list[i]) %in% ANC.other ==  :  no non-missing arguments to min; returning Inf" 

Replace.groups<- function  (Lower.Phyl, Monop.group ) {
require(ape); require(phylobase)
#Find the species in Lower.Phyl which are also included in PHYLO (this list is called Core)
	Core<-unlist(Lower.Phyl[3])[unlist(Lower.Phyl[3])%in%unlist(PHYLO[3])==T]
	Lower.Phyl<-compute.brlen(Lower.Phyl, 1)
	PHYLO4_Lower.Phyl<-phylo4(Lower.Phyl)
#Find the clades of species in Lower.Phyl which are closest related to exactly one species in Core
	L<-1:length(Core)
	ANC.list<-numeric(max(L)) ; for (i in L) { ANC.list[i]<-list(ancestors(PHYLO4_Lower.Phyl,Core[i]))}
	ANC.unique<-numeric(max(L)) ; for (i in L) { ANC.other<-c(unlist(ANC.list[L[L!=i]])) ; ANC.unique[i]<-min(unlist(ANC.list[i])[unlist(ANC.list[i])%in%ANC.other==FALSE])}
	Core.New<-Core[ANC.unique<10^6]  ; ANC<-ANC.unique[ANC.unique<10^6]
#Replace each member of Core with these clades in the overall phylogeny PHYLO
	PHYLO<-compute.brlen(PHYLO, 1)
	if (length(Core.New)>0) {
	for (i in 1:length(Core.New)){  PHYLO<-bind.tree(PHYLO, extract.clade(Lower.Phyl, as.numeric(ANC[i])),   getNode(phylo4(PHYLO), Core.New[i]))}
	PHYLO<<-PHYLO
#Test to see if there are any species in Lower.Phyl which have not been incorporated in PHYLO yet (because they are equally closely related to several species in Core
	Decen<-numeric( length(ANC)) ; for (i in 1:length(ANC)){ Decen[i]<-list(descendants(PHYLO4_Lower.Phyl, ANC[i]))}
	GetCore<-numeric(length(Core))
	for (i in 1:length(Core)){ GetCore[i]<-getNode(PHYLO4_Lower.Phyl, Core[i])}} 
	else {GetCore<-numeric(length(Core))
	for (i in 1:length(Core)){GetCore[i]<-getNode(PHYLO4_Lower.Phyl, Core[i])}; Decen<-numeric(0);PHYLO<<-PHYLO}
	Decent<-c(unlist(Decen), GetCore )
	All<-1:length(unlist(Lower.Phyl[3])) ;Rest<<-All[All%in%Decent==FALSE]
#Place remaining species
	repeat{ if (length(Rest)==0 ) break else
	ANC.new<-ancestors(PHYLO4_Lower.Phyl,max(Rest))[ancestors(PHYLO4_Lower.Phyl,max(Rest))%in%unlist(ANC.list)==FALSE]
	if (length(ANC.new)==0)  {Clade<-read.tree(text="(X:1);") ;  Clade[4]<-labels(getNode(PHYLO4_Lower.Phyl, max(Rest)))} else Clade<-extract.clade(Lower.Phyl, min(ANC.new), root.edge=5) 
	Shared.Ances<-numeric(length(GetCore))
	for (i in 1:length(GetCore)) {Shared.Ances[i]<-MRCA(PHYLO4_Lower.Phyl, max(Rest), GetCore[i])}
	PHYLO<-compute.brlen(PHYLO, 1)
	Place<-MRCA(phylo4(PHYLO),  unlist(PHYLO[3])[unlist(PHYLO[3])%in%labels(descendants(PHYLO4_Lower.Phyl,max(Shared.Ances)))==T])
	Test_of_Place<-descendants(phylo4(PHYLO), Place)
	if(length(names(Test_of_Place)[names(Test_of_Place)%in%Monop.group==F])==0) Place<-Place else
	{PHYLO4<-phylo4(PHYLO);  POTENTIALS<-names(Test_of_Place)[names(Test_of_Place)%in%Monop.group]
	MONOP.ANC<-MONOP.ANC2<-getNode(PHYLO4, unlist(POTENTIALS)[1]); repeat { if(length(names(descendants(PHYLO4, MONOP.ANC2)[names(descendants(PHYLO4, MONOP.ANC2))%in%Monop.group==F]))>0) break else {MONOP.ANC2->MONOP.ANC; MONOP.ANC2<-ancestor(PHYLO4,MONOP.ANC)}} 
	MONOP.prop<-length(descendants(PHYLO4, MONOP.ANC))
	POTENTIALS<-POTENTIALS[POTENTIALS%in%names(descendants(PHYLO4, MONOP.ANC))==F]; MONOP.ANC3<-numeric(0)
	repeat { if(length(POTENTIALS)==0) break else MONOP.ANC2<-MONOP.ANC3<-getNode(PHYLO4, unlist(POTENTIALS)[1]); repeat { if(length(names(descendants(PHYLO4, MONOP.ANC3)[names(descendants(PHYLO4, MONOP.ANC3))%in%Monop.group==F]))>0) break else {MONOP.ANC3->MONOP.ANC2; MONOP.ANC3<-ancestor(PHYLO4,MONOP.ANC2)}} 
	MONOP.ANC<-c(MONOP.ANC, MONOP.ANC2); MONOP.prop<-c(MONOP.prop, length(descendants(PHYLO4, MONOP.ANC2))); POTENTIALS<-POTENTIALS[POTENTIALS%in%names(descendants(PHYLO4, MONOP.ANC2))==F]}
	if (length(MONOP.ANC)==1) Place<-MONOP.ANC else Place<-sample(MONOP.ANC, 1, prob=MONOP.prop)}
	PHYLO<-bind.tree(x=PHYLO, y=Clade,   where=Place , 0.5)
	PHYLO<<-PHYLO
	if (length(ANC.new)>0) ANC<-c(ANC,min(ANC.new)) else ANC<-c(ANC, max(Rest))
	Decen<-numeric( length(ANC)) ; for (i in 1:length(ANC)){ Decen[i]<-list(descendants(PHYLO4_Lower.Phyl, ANC[i]))}
	Decent<-c(unlist(Decen), GetCore )
	All<-1:length(unlist(Lower.Phyl[3]))
	All[All%in%Decent==FALSE]->Rest}
	PHYLO<-read.tree(text=write.tree(PHYLO))
	PHYLO<<-compute.brlen(PHYLO, 1)}

#Example:
GEN<-read.tree(text="(Herpestes_naso:0.059867,(((Herpestes_ichneumon:0.070671,Herpestes_pulverulentus:0.03896):0.003005,Herpestes_sanguineus:0.086637):0.01955,(((Herpestes_urva:0.054787,Herpestes_brachyurus:0.056239):0.032974,(Herpestes_fuscus:0.090268,(Herpestes_javanicus:0.052935,Herpestes_edwardsii:0.015697):0.032601):0.017434):0.006213,(Herpestes_smithii:0.051002,Herpestes_vitticollis:0.046112):0.008548):0.012125):0.033055);")
PHYLO<-read.tree(text="(((((Crossarchus_obscurus:0.044921,(Helogale_hirtula:0.027009,Helogale_parvula:0.013268):0.040682):0.017187,Suricata_suricatta:0.068963):0.004735,Mungos_mungo:0.080056):0.010105,Liberiictis_kuhni:0.05688):0.009995,(((Herpestes_ichneumon:0.03304,Herpestes_sanguineus:0.045):0.000797,Herpestes_pulverulentus:0.045014):0.014734,((((Cynictis_penicillata:0.02703,Paracynictis_selousi:0.016887):0.009521,((Bdeogale_nigripes:0.01969,Bdeogale_crassicauda:0.014933):0.022564,Rhynchogale_melleri:0.031211):0.00837):0.024763,Ichneumia_albicauda:0.04287):0.008954,((Herpestes_naso:0.049347,((Herpestes_fuscus:0.046316,(Herpestes_javanicus:0.015506,Herpestes_edwardsii:0.017468):0.019561):0.021997,Herpestes_brachyurus:0.028012):0.002778):0.002477,Atilax_paludinosus:0.026257):0.007386):0.01173):0.040755);")
MONOP.GROUP<-c("Herpestes_brachyurus", "Herpestes_edwardsii", "Herpestes_fuscus", "Herpestes_ichneumon", "Herpestes_javanicus", "Herpestes_naso", "Herpestes_pulverulentus", "Herpestes_sanguineus", "Herpestes_smithii", "Herpestes_urva", "Herpestes_vitticollis")

#PHYLO is one of the trees from a family level phylogenetic analysis of Herpestidae
#GEN is one of the trees from a genus level phylogenetic analysis of Herpestes
#MONOP.GROUP is a list of the species in the genus Herpestes which is assumed to be monophyletic unless there is evidence against in the higher order phylogeny
Replace.groups( GEN, MONOP.GROUP)
#The tree can be visualized
plot(PHYLO)
#Note that Herpestes is polyphyletic in the resulting tree which we allow since the polyphyly is already present in the initial family level analysis and we only require that no new polyphyly is generated by the merging of hte two trees


####################################################################################################################
#######################################Adding species without genetic data##########################################
####################################################################################################################
#The simplest function in this regard requires as input a species in the tree and an unsampled species assumed to be the sister to it. 
#The tree in this and the following functions is assumed to be called PHYLO
Sister1<- function  (Included, Missing ) {
require(phylobase)
St<-read.tree(text="(X:1,Y:1);") ; St[3]<-list(c(Included,Missing))
PHYLO<<-bind.tree(PHYLO, St,    getNode(phylo4(PHYLO), Included))}

#Example:
PHYLO<-read.tree(text="(((((Crossarchus_obscurus:0.044921,(Helogale_hirtula:0.027009,Helogale_parvula:0.013268):0.040682):0.017187,Suricata_suricatta:0.068963):0.004735,Mungos_mungo:0.080056):0.010105,Liberiictis_kuhni:0.05688):0.009995,(((Herpestes_ichneumon:0.03304,Herpestes_sanguineus:0.045):0.000797,Herpestes_pulverulentus:0.045014):0.014734,((((Cynictis_penicillata:0.02703,Paracynictis_selousi:0.016887):0.009521,((Bdeogale_nigripes:0.01969,Bdeogale_crassicauda:0.014933):0.022564,Rhynchogale_melleri:0.031211):0.00837):0.024763,Ichneumia_albicauda:0.04287):0.008954,((Herpestes_naso:0.049347,((Herpestes_fuscus:0.046316,(Herpestes_javanicus:0.015506,Herpestes_edwardsii:0.017468):0.019561):0.021997,Herpestes_brachyurus:0.028012):0.002778):0.002477,Atilax_paludinosus:0.026257):0.007386):0.01173):0.040755);")
Sister1("Herpestes_sanguineus", "Herpestes_ochraceus")
#This code adds Herpestes_ochraceus as sister to Herpestes_sanguineus

#Another simple function replaces a singled sampled samples with a randomly resolved tritomy 
Sister2<- function  (Included, Missing1, Missing2 ) {
require(phylobase)
St1<-read.tree(text="((X:1,Y:1):1,Z:1);"); St2<-read.tree(text="((X:1,Y:1):1,Z:1);"); St3<-read.tree(text="((X:1,Y:1):1,Z:1);")
St1[3]<-list(c(Included,Missing1, Missing2)); St2[3]<-list(c(Included,Missing2, Missing1)); St3[3]<-list(c(Missing1, Missing2, Included)) 
Rand<-sample.int(3,1)
if (Rand==1) PHYLO<<-bind.tree(PHYLO, St1, getNode(phylo4(PHYLO), Included)) else if (Rand==2)  PHYLO<<-bind.tree(PHYLO, St2, getNode(phylo4(PHYLO), Included))  else  PHYLO<<-bind.tree(PHYLO, St3, getNode(phylo4(PHYLO), Included))}

#Example:
PHYLO<-read.tree(text="(((((Crossarchus_obscurus:0.044921,(Helogale_hirtula:0.027009,Helogale_parvula:0.013268):0.040682):0.017187,Suricata_suricatta:0.068963):0.004735,Mungos_mungo:0.080056):0.010105,Liberiictis_kuhni:0.05688):0.009995,(((Herpestes_ichneumon:0.03304,Herpestes_sanguineus:0.045):0.000797,Herpestes_pulverulentus:0.045014):0.014734,((((Cynictis_penicillata:0.02703,Paracynictis_selousi:0.016887):0.009521,((Bdeogale_nigripes:0.01969,Bdeogale_crassicauda:0.014933):0.022564,Rhynchogale_melleri:0.031211):0.00837):0.024763,Ichneumia_albicauda:0.04287):0.008954,((Herpestes_naso:0.049347,((Herpestes_fuscus:0.046316,(Herpestes_javanicus:0.015506,Herpestes_edwardsii:0.017468):0.019561):0.021997,Herpestes_brachyurus:0.028012):0.002778):0.002477,Atilax_paludinosus:0.026257):0.007386):0.01173):0.040755);")
Sister2("Crossarchus_obscurus", "Crossarchus_alexandri", "Crossarchus_ansorgei")
#This code replaces Crossarchus_obscurus with Crossarchus_obscurus, Crossarchus_alexandri and Crossarchus_ansorgei and randomly resolves the relationship between the three species

#The following function handles situations where the missing species is thought to be the sister of multiple species listed as Included. 
#If the species in Included are not monophyletic the missing species is places as sister to a monophyletic part 
#with a probability proportional to the number of species in the monophyletic part.
SisterAnd1<-function  (Included, Missing ) {
require(phylobase)
PHYLO<<-compute.brlen(PHYLO,1)
St<-read.tree(text="(X:1);") ; St[4]<-Missing
if (length(descendants(phylo4(PHYLO), MRCA(phylo4(PHYLO), Included)))==length(Included)) PHYLO<<-bind.tree(x=PHYLO, y=St,   where=MRCA(phylo4(PHYLO), Included), position=0.5) else
{ Inc<-numeric(length(Included)); for (i in 1:length(Inc)) {Inc[i]<-getNode(phylo4(PHYLO), Included[i])};   Place<-Included[sample.int(length(Included),1)];
Pl_NEW<-ancestor(phylo4(PHYLO), Place); Des<-descendants(phylo4(PHYLO), Pl_NEW);
repeat{ if(length(Des[Des%in%Inc==F])>0) {PHYLO<<-bind.tree(x=PHYLO, y=St,   where=getNode(phylo4(PHYLO), Place)  , position=0.5); break} else {Pl_NEW->Place; Pl_NEW<-ancestor(phylo4(PHYLO), Place); Des<-descendants(phylo4(PHYLO), Pl_NEW)}}}
PHYLO<<-compute.brlen(PHYLO,1)}

#Example:
PHYLO<-read.tree(text="(((((Crossarchus_obscurus:0.044921,(Helogale_hirtula:0.027009,Helogale_parvula:0.013268):0.040682):0.017187,Suricata_suricatta:0.068963):0.004735,Mungos_mungo:0.080056):0.010105,Liberiictis_kuhni:0.05688):0.009995,(((Herpestes_ichneumon:0.03304,Herpestes_sanguineus:0.045):0.000797,Herpestes_pulverulentus:0.045014):0.014734,((((Cynictis_penicillata:0.02703,Paracynictis_selousi:0.016887):0.009521,((Bdeogale_nigripes:0.01969,Bdeogale_crassicauda:0.014933):0.022564,Rhynchogale_melleri:0.031211):0.00837):0.024763,Ichneumia_albicauda:0.04287):0.008954,((Herpestes_naso:0.049347,((Herpestes_fuscus:0.046316,(Herpestes_javanicus:0.015506,Herpestes_edwardsii:0.017468):0.019561):0.021997,Herpestes_brachyurus:0.028012):0.002778):0.002477,Atilax_paludinosus:0.026257):0.007386):0.01173):0.040755);")
SisterAnd1(c("Helogale_hirtula", "Helogale_parvula"),  "Dologale_dybowskii")
#This code adds Dologale_dybowskii as a sister to  Helogale_hirtula and Helogale_parvula

#The two functions Sister1 and SisterAnd1 can be combined in situations where there are multiple possible placements using the function SisterOrSing1
SisterOrSing1<-function  (Included, Missing ) {Sister<-Included[sample.int(length(Included),1)]; if (length(unlist(Sister))==1)  Sister1(unlist(Sister), Missing) else SisterAnd1(unlist(Sister), Missing) }

#Simplest example
PHYLO<-read.tree(text="(((((Crossarchus_obscurus:1,(Helogale_hirtula:1,Helogale_parvula:1):1):1,Suricata_suricatta:1):1,Mungos_mungo:1):1,Liberiictis_kuhni:1):1,(((Herpestes_ichneumon:1,Herpestes_sanguineus:1):1,Herpestes_pulverulentus:1):1,((((Cynictis_penicillata:1,Paracynictis_selousi:1):1,((Bdeogale_nigripes:1,Bdeogale_crassicauda:1):1,Rhynchogale_melleri:1):1):1,Ichneumia_albicauda:1):1,((Herpestes_naso:1,(((Herpestes_fuscus:1,(Herpestes_javanicus:1,Herpestes_edwardsii:1):1):1,(Herpestes_urva:1,Herpestes_brachyurus:1):1):1,(Herpestes_smithii:1,Herpestes_vitticollis:1):1):1):1,Atilax_paludinosus:1):1):1):1);")
SisterOrSing1(c("Herpestes_edwardsii", "Herpestes_fuscus", "Herpestes_javanicus","Herpestes_smithii"), "Herpestes_semitorquatus")
#This code adds Herpestes_semitorquatus as a sister to  Herpestes_edwardsii, Herpestes_fuscus, Herpestes_javanicus or Herpestes_smithii

#Combination of SisterAnd1 and Sister1. We could for instance add Herpestes_semitorquatus as a sister to Herpestes_edwardsii and Herpestes_javanicus or Herpestes_fuscus and Herpestes_smithii
PHYLO<-read.tree(text="(((((Crossarchus_obscurus:1,(Helogale_hirtula:1,Helogale_parvula:1):1):1,Suricata_suricatta:1):1,Mungos_mungo:1):1,Liberiictis_kuhni:1):1,(((Herpestes_ichneumon:1,Herpestes_sanguineus:1):1,Herpestes_pulverulentus:1):1,((((Cynictis_penicillata:1,Paracynictis_selousi:1):1,((Bdeogale_nigripes:1,Bdeogale_crassicauda:1):1,Rhynchogale_melleri:1):1):1,Ichneumia_albicauda:1):1,((Herpestes_naso:1,(((Herpestes_fuscus:1,(Herpestes_javanicus:1,Herpestes_edwardsii:1):1):1,(Herpestes_urva:1,Herpestes_brachyurus:1):1):1,(Herpestes_smithii:1,Herpestes_vitticollis:1):1):1):1,Atilax_paludinosus:1):1):1):1);")
SisterOrSing1(c(list(c("Herpestes_edwardsii", "Herpestes_javanicus")), list(c("Herpestes_fuscus","Herpestes_smithii"))), "Herpestes_semitorquatus")
#This code would normally have a 50% chance of adding Herpestes_semitorquatus as a sister to Herpestes_edwardsii and Herpestes_javanicus and 50% chance as a sister to Herpestes_fuscus and Herpestes_smithii
#Since Herpestes_fuscus and Herpestes_smithii are not sisters in the phylogeny it is however added with the following propertions instead
#50% sister to Herpestes_edwardsii and Herpestes_javanicus, 25% sister to Herpestes_fuscus and 25% sister to Herpestes_smithii

#The code can also easily be modified to adding multiple species as seen in this example adding Herpestes_SP1 and Herpestes_SP2 in random order
#This corresponds to a situation where the relationship between Herpestes_edwardsii, Herpestes_fuscus, Herpestes_javanicus,Herpestes_smithii Herpestes_SP1 and Herpestes_SP2 is unresolved
PHYLO<-read.tree(text="(((((Crossarchus_obscurus:1,(Helogale_hirtula:1,Helogale_parvula:1):1):1,Suricata_suricatta:1):1,Mungos_mungo:1):1,Liberiictis_kuhni:1):1,(((Herpestes_ichneumon:1,Herpestes_sanguineus:1):1,Herpestes_pulverulentus:1):1,((((Cynictis_penicillata:1,Paracynictis_selousi:1):1,((Bdeogale_nigripes:1,Bdeogale_crassicauda:1):1,Rhynchogale_melleri:1):1):1,Ichneumia_albicauda:1):1,((Herpestes_naso:1,(((Herpestes_fuscus:1,(Herpestes_javanicus:1,Herpestes_edwardsii:1):1):1,(Herpestes_urva:1,Herpestes_brachyurus:1):1):1,(Herpestes_smithii:1,Herpestes_vitticollis:1):1):1):1,Atilax_paludinosus:1):1):1):1);")
Start<-c("Herpestes_edwardsii", "Herpestes_fuscus", "Herpestes_javanicus","Herpestes_smithii")
MIS<-c("Herpestes_SP1", "Herpestes_SP2")
MIS1<-MIS[sample.int(2, 1)]; SisterOrSing1(Start, MIS1); MIS<-MIS[MIS%in%MIS1==F]; Start<-c(Start, MIS1)
SisterOrSing1(Start, MIS)

####################################################################################################################
###############################################Simulating branch lengths############################################
####################################################################################################################
#The following function simulates branch lengths based on a desired age of the first split (AGE)
#Once again the function assumes that the tree is called PHYLO
#The first function YULE.gen simulates branches based a Yule model.
#The second one BD.gen estimates branch lengths based on a relative extinction rate relative to the speciation rate (called DEATH)

YULE.gen<-function(AGE){
require (geiger)
require (phylobase)
BRAN<-DESC<-numeric(unlist(PHYLO[2])-1)
PHYLO4<-phylo4(PHYLO)
TIPS<-length(PHYLO$tip.label)
NODES<-TIPS+unlist(PHYLO[2])-1
for (i in 1:length(DESC)) {DESC[i]<-length(descendants(PHYLO4, (TIPS+1+i)));  TREE<-sim.bdtree(b=1, d=0, stop=c("taxa"), n=(DESC[i]+2)); BRAN[i]<-1-sort(branching.times(TREE), decreasing=T)[2]/branching.times(TREE)[1]}
Nodes<-numeric(NODES)
for (i in 1:NODES){
A<-c(unlist(PHYLO[1])[i], unlist(PHYLO[1])[i+NODES]); A<-A[is.na(A)==F]; A<-unique(c(unlist(ancestors(PHYLO4, A)),A))
if (min(A)>TIPS) {A<-(A[A>TIPS+1])-TIPS-1; HB<-max(A); A<-sort(A, decreasing=T)[-1]; if(length(A)==0) Nodes[i]<-BRAN[HB]*AGE else Nodes[i]<-BRAN[HB]*AGE*prod(1-BRAN[A])}
else {A<-(A[A>TIPS+1])-TIPS-1; Nodes[i]<-AGE*prod(1-BRAN[A])}}
PHYLO<<-(compute.brlen(PHYLO, Nodes))}

BD.gen<-function(AGE,DEATH){
require (geiger)
require (phylobase)
BRAN<-DESC<-numeric(unlist(PHYLO[2])-1)
PHYLO4<-phylo4(PHYLO)
TIPS<-length(PHYLO$tip.label)
NODES<-TIPS+unlist(PHYLO[2])-1
for (i in 1:length(DESC)) {DESC[i]<-length(descendants(PHYLO4, (TIPS+1+i)));  TREE<-drop.extinct(sim.bdtree(b=1, d=DEATH, t=20, stop=c("taxa"), n=(DESC[i]+2), extinct=F)); BRAN[i]<-1-sort(branching.times(TREE), decreasing=T)[2]/branching.times(TREE)[1]}
Nodes<-numeric(NODES)
for (i in 1:NODES){
A<-c(unlist(PHYLO[1])[i], unlist(PHYLO[1])[i+NODES]); A<-A[is.na(A)==F]; A<-unique(c(unlist(ancestors(PHYLO4, A)),A))
if (min(A)>TIPS) {A<-(A[A>TIPS+1])-TIPS-1; HB<-max(A); A<-sort(A, decreasing=T)[-1]; if(length(A)==0) Nodes[i]<-BRAN[HB]*AGE else Nodes[i]<-BRAN[HB]*AGE*prod(1-BRAN[A])}
else {A<-(A[A>TIPS+1])-TIPS-1; Nodes[i]<-AGE*prod(1-BRAN[A])}}
PHYLO<<-(compute.brlen(PHYLO, Nodes))}

####################################################################################################################
#################################################Handling large polytomies##########################################
####################################################################################################################
#The following functions are designed to handle large polytomies in the non-genetic dataset with very limited genetic data.
#Separate functions have been written for each combination of sampled and missing species e.g. Rep_2_4 handles four-way polytomies with two sampled species
#As described in the text polytomies with 12 or more species with less than half having genetic data. 
#These functions have added an ODD to their name e.g. Rep_2_22ODD
#The input format for all functions are the same and they all require the named species separated by a comma,
#followed by all the missing species separated in an parenthesis
#Users of the code should note that the function handling polytomies with 11 species four of which is sampled is called Rep_4_11_Part
#This function will not work for all input trees and will generate the error "ERROR THIS NOT DONE"
#if none of the four species with genetic data are related to each other
#No function has been written for polytomies with only one sampled species since they can be directly handled with bind.tree as the following example with Cretan deer 
#TR<-read.tree(text="((((Candiacervus_ropalophorus:1, Candiacervus_SpII:1, Candiacervus_cretensis:1, Candiacervus_rethymnensis:1, Candiacervus_dorothensis:1, Candiacervus_major:1):1, Praemegaceros_cazioti:1):1, Megaloceros_giganteus:1):1, ((Sinomegaceros_yabei:1, Sinomegaceros_ordosianus:1):1, Megaceroides_algericus:1):1):1;")
#PHYLO<<-bind.tree(PHYLO, TR ,  getNode(phylo4(PHYLO),"Megaloceros_giganteus"))

Rep_2_4<-function  (Inc1, Inc2, Missings) {
if (is.monophyletic(PHYLO, c(Inc1, Inc2 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1 );") ; St[3]<-list(c(Inc1,Inc2, Missings[1], Missings[2]));PHYLO<<-drop.tip(PHYLO, Inc1); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} else 
{cbind(c(Missings[1], Missings[2]) ,c(sample.int(2,2, replace=T)))->>S;  S[,1][S[,2]==1]->S1; S2<-S[,1][S[,2]==2]
 if(length(S1)==2) Sister2(Inc1, Missings[1], Missings[2]) else if(length(S1)==0) Sister2(Inc2, Missings[1], Missings[2]) else {Sister1(Inc1, S1[1]); Sister1(Inc2, S2[1])}}
 plot(PHYLO)}

Rep_2_5<-function  (Inc1, Inc2, Missings) {
if (is.monophyletic(PHYLO, c(Inc1, Inc2 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc1,Inc2, Missings[1], Missings[2], Missings[3]));PHYLO<<-drop.tip(PHYLO, Inc1); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} else 
{cbind(c(Missings[1], Missings[2], Missings[3]) ,c(sample.int(2,3, replace=T)))->>S;  S[,1][S[,2]==1]->S1; S2<-S[,1][S[,2]==2]
if(length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1 );") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))} else
if(length(S1)==0) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1 );") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} else
 if(length(S1)==2) {Sister2(Inc1, S1[1], S1[2]); Sister1(Inc2, S2[1])} else {Sister2(Inc2, S2[1], S2[2]); Sister1(Inc1, S1[1])}}
 plot(PHYLO)}

Rep_2_6<-function  (Inc1, Inc2, Missings) {
if (is.monophyletic(PHYLO, c(Inc1, Inc2 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc1,Inc2, Missings[1], Missings[2], Missings[3], Missings[4]));PHYLO<<-drop.tip(PHYLO, Inc1); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} else 
{cbind(c(Missings[1], Missings[2], Missings[3], Missings[4]) ,c(sample.int(2,4, replace=T)))->>S;  S[,1][S[,2]==1]->S1; S2<-S[,1][S[,2]==2]
if(length(S1)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1 );") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))} else
if(length(S1)==0) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1 );") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} else
if(length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1 );") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); Sister1(Inc2, S2[1])} else
if(length(S1)==1) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1 );") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); Sister1(Inc1, S1[1])} else
{Sister2(Inc1, S1[1], S1[2]); Sister2(Inc2, S2[1], S2[2])}}
 plot(PHYLO)}

Rep_2_7<-function  (Inc1, Inc2, Missings) {
if (is.monophyletic(PHYLO, c(Inc1, Inc2 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(Inc1,Inc2, Missings[1], Missings[2], Missings[3], Missings[4], Missings[5]));PHYLO<<-drop.tip(PHYLO, Inc1); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} else 
{cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5]) ,c(sample.int(2,5, replace=T)))->>S;  S[,1][S[,2]==1]->S1; S2<-S[,1][S[,2]==2]
if(length(S1)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1 );") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))} else
if(length(S1)==0) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1 );") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} else
if(length(S1)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1 );") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); Sister1(Inc2, S2[1])} else
if(length(S1)==1) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1 );") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); Sister1(Inc1, S1[1])} else
if(length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); Sister2(Inc2, S2[1], S2[2])} else
{St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); Sister2(Inc1, S1[1], S1[2])}}
 plot(PHYLO)}

Rep_2_8<-function  (Inc1, Inc2, Missings) {
if (is.monophyletic(PHYLO, c(Inc1, Inc2 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1);") ; St[3]<-list(c(Inc1,Inc2, Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6]));PHYLO<<-drop.tip(PHYLO, Inc1); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} else 
{cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6]) ,c(sample.int(2,6, replace=T)))->>S;  S[,1][S[,2]==1]->S1; S2<-S[,1][S[,2]==2]
if(length(S1)==6) {A<<-6; St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1 );") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))} else
if(length(S1)==0) {A<<-0; St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1 );") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5], S2[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} else
if(length(S1)==5) {A<<-5; St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1 );") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); Sister1(Inc2, S2[1])} else
if(length(S1)==1) {A<<-1; St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1 );") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); Sister1(Inc1, S1[1])} else
if(length(S1)==4) {A<<-4; St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); Sister2(Inc2, S2[1], S2[2])} else
if(length(S1)==2) {A<<-2; St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4])); PHYLO2<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); Sister2(PHYLO2, Inc1, S1[1], S1[2])} else
{A<<-3; St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO2<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); St[3]<-list(c(Inc2, S2[1], S2[2], S2[3]));   PHYLO<<-bind.tree(PHYLO2,  St, getNode(phylo4(PHYLO2), Inc2))}}
 plot(PHYLO)}

Rep_2_9<-function  (Inc1, Inc2, Missings) {
if (is.monophyletic(PHYLO, c(Inc1, Inc2 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1);") ; St[3]<-list(c(Inc1,Inc2, Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6], Missings[7]));PHYLO<<-drop.tip(PHYLO, Inc1); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} else 
{cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6], Missings[7]), c(sample.int(2,7, replace=T)))->>S;;  S[,1][S[,2]==1]->S1; S2<-S[,1][S[,2]==2]
if(length(S1)==7) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1 );") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6], S1[7])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))} else
if(length(S1)==0) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1 );") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5], S2[6], S2[7])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} else
if(length(S1)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1 );") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6] )); PHYLO2<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); Sister1(PHYLO2, Inc2, S2[1])} else
if(length(S1)==1) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1 );") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5], S2[6])); PHYLO2<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); Sister1(PHYLO2, Inc1, S1[1])} else
if(length(S1)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5])); PHYLO2<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); Sister2(PHYLO2, Inc2, S2[1], S2[2])} else
if(length(S1)==2) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5])); PHYLO2<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); Sister2(PHYLO2, Inc1, S1[1], S1[2])} else
if(length(S1)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4])); PHYLO2<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3]));   PHYLO<<-bind.tree(PHYLO2, St, getNode(phylo4(PHYLO2), Inc2))} else
{St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4])); PHYLO2<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3]));   PHYLO<<-bind.tree(PHYLO2, St, getNode(phylo4(PHYLO2), Inc1))}}
 plot(PHYLO)}

Rep_2_10<-function  (Inc1, Inc2, Missings) {
if (is.monophyletic(PHYLO, c(Inc1, Inc2 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1);") ; St[3]<-list(c(Inc1,Inc2, Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6], Missings[7], Missings[8]));PHYLO<<-drop.tip(PHYLO, Inc1); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} else 
{cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6], Missings[7], Missings[8]), c(sample.int(2,8, replace=T)))->>S;  S[,1][S[,2]==1]->S1; S2<-S[,1][S[,2]==2]
if(length(S1)==8) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6], S1[7], S1[8])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))} else
if(length(S1)==0) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1 ,Tip9:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5], S2[6], S2[7], S2[8])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} else
if(length(S1)==7) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1 );") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6], S1[7] )); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); Sister1(Inc2, S2[1])} else
if(length(S1)==1) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1 );") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5], S2[6], S2[7])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); Sister1(Inc1, S1[1])} else
if(length(S1)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); Sister2(Inc2, S2[1], S2[2])} else
if(length(S1)==2) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5], S2[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); Sister2(Inc1, S1[1], S1[2])} else
if(length(S1)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3]));   PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} else
if(length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3]));   PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))} else
{St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4]));   PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}}
plot(PHYLO)}

Rep_2_12ODD<-function  (Inc1, Inc2, Missings) {
Inc1_M<-sample.int(10,10); Inc2_M<-Inc1_M[6:10]; Inc1_M=Inc1_M[1:5]
if (is.monophyletic(PHYLO, c(Inc1, Inc2))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1);") ; St[3]<-list(c(Inc1,Inc2,  Missings[1], Missings[2], Missings[3], Missings[4], Missings[5],  Missings[6],  Missings[7],  Missings[8],  Missings[9],  Missings[10]));PHYLO<-drop.tip(PHYLO, Inc1) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}   
else { St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);"); St[3]<-list(c(Inc1, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
 St[3]<-list(c(Inc2, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}}

Rep_2_14ODD<-function  (Inc1, Inc2, Missings) {
Inc1_M<-sample.int(12,12); Inc2_M<-Inc1_M[7:12]; Inc1_M=Inc1_M[1:6]
if (is.monophyletic(PHYLO, c(Inc1, Inc2))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1);") ; St[3]<-list(c(Inc1,Inc2,  Missings[1], Missings[2], Missings[3], Missings[4], Missings[5],  Missings[6],  Missings[7],  Missings[8],  Missings[9],  Missings[10],  Missings[11],  Missings[12]));PHYLO<-drop.tip(PHYLO, Inc1) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}   
else { St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);"); St[3]<-list(c(Inc1, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc1_M[6]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
 St[3]<-list(c(Inc2, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]], Missings[Inc2_M[6]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}}


Rep_2_22ODD<-function  (Inc1, Inc2, Missings) {
Inc1_M<-sample.int(20,20); Inc2_M<-Inc1_M[11:20]; Inc1_M=Inc1_M[1:10]
if (is.monophyletic(PHYLO, c(Inc1, Inc2))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1, Tip15:1, Tip16:1, Tip17:1, Tip18:1, Tip19:1, Tip20:1, Tip21:1, Tip22:1);") ; St[3]<-list(c(Inc1,Inc2,  Missings[1], Missings[2], Missings[3], Missings[4], Missings[5],  Missings[6],  Missings[7],  Missings[8],  Missings[9],  Missings[10],  Missings[11],  Missings[12],  Missings[13],  Missings[14],  Missings[15],  Missings[16],  Missings[17],  Missings[18],  Missings[19],  Missings[20]));PHYLO<-drop.tip(PHYLO, Inc1) ; PHYLO<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} else 
{St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1);")
St[3]<-list(c(Inc1, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc1_M[6]], Missings[Inc1_M[7]], Missings[Inc1_M[8]], Missings[Inc1_M[9]], Missings[Inc1_M[10]]));  PHYLO<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
St[3]<-list(c(Inc2, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]], Missings[Inc2_M[6]], Missings[Inc2_M[7]], Missings[Inc2_M[8]], Missings[Inc2_M[9]], Missings[Inc2_M[10]]));  PHYLO<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}
PHYLO<<-PHYLO}

Rep_3_6<-function  (Inc1, Inc2, Inc3, Missings) {
	if (is.monophyletic(PHYLO,c(Inc1, Inc2, Inc3 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc1,Inc2, Inc3,  Missings[1], Missings[2], Missings[3]));PHYLO<<-drop.tip(PHYLO, Inc1) ;PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} else
	if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T||is.monophyletic(PHYLO,c(Inc1, Inc3))==T||is.monophyletic(PHYLO,c(Inc2, Inc3))==T) {{if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T) {Inc1->Mo1; Inc2->Mo2; Inc3->NM} else if (is.monophyletic(PHYLO,c(Inc1, Inc3))==T) {Inc1->Mo1; Inc3->Mo2; Inc2->NM} else {Inc2->Mo1; Inc3->Mo2; Inc1->NM}}
		cbind(c(Missings[1], Missings[2], Missings[3]),  c(sample.int(2,3, replace=T, prob = c(1,2))))->>SU; Sam<-SU[,1][SU[,2]==2]; Unsam<-SU[,1][SU[,2]==1]
 		if(length(Sam)==0)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM))}
		else  if(length(Sam)==1) {Sister2(NM, Unsam[1], Unsam[2]); SisterOrSing1( c(Mo1, Mo2), Sam[1])}
		else if (length(Sam)==2) {Sister1(NM, Unsam[1]);  Rep_2_4(Mo1, Mo2, c(Sam[1], Sam[2]))} else  Rep_2_5(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3]))}
	else {cbind(c(Missings[1], Missings[2], Missings[3]) ,c(sample.int(3,3, replace=T)))->>SU; S1<-SU[,1][SU[,2]==1]; S2<-SU[,1][SU[,2]==2];S3<-SU[,1][SU[,2]==3]
		if(length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))}
		else  if(length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}
		else  if(length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}
		else  if(length(S1)==2) {Sister2(Inc1, S1[1], S1[2]);  if (length(S2)==1) Sister1( Inc2, S2[1]) else Sister1( Inc3, S3[1])}
		else  if(length(S2)==2) {Sister2(Inc2, S2[1], S2[2]);  if (length(S1)==1) Sister1( Inc1, S1[1]) else Sister1( Inc3, S3[1])}
		else  if(length(S3)==2) {Sister2(Inc1, S3[1], S3[2]);  if (length(S1)==1) Sister1( Inc1, S1[1]) else Sister1( Inc2, S2[1])}
		else {Sister1(Inc1, S1[1]); Sister1( Inc2, S2[1]); Sister1( Inc3, S3[1])}}
 plot(PHYLO)}


Rep_3_7<-function  (Inc1, Inc2, Inc3, Missings) {
	if (is.monophyletic(PHYLO,c(Inc1, Inc2, Inc3 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(Inc1,Inc2, Inc3,  Missings[1], Missings[2], Missings[3], Missings[4]));PHYLO<<-drop.tip(PHYLO, Inc1) ;PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} else
	if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T||is.monophyletic(PHYLO,c(Inc1, Inc3))==T||is.monophyletic(PHYLO,c(Inc2, Inc3))==T) {{if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T) {Inc1->Mo1; Inc2->Mo2; Inc3->NM} else if (is.monophyletic(PHYLO,c(Inc1, Inc3))==T) {Inc1->Mo1; Inc3->Mo2; Inc2->NM} else {Inc2->Mo1; Inc3->Mo2; Inc1->NM}}
		cbind(c(Missings[1], Missings[2], Missings[3], Missings[4]),  c(sample.int(2,4, replace=T, prob = c(1,2))))->>SU; Sam<-SU[,1][SU[,2]==2]; Unsam<-SU[,1][SU[,2]==1]
 		if(length(Sam)==0)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1 );") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM))}
		else  if(length(Sam)==1) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM)); SisterOrSing1( c(Mo1, Mo2), Sam[1])}
		else  if(length(Sam)==2) {Sister2(NM, Unsam[1], Unsam[2]);  Rep_2_4(Mo1, Mo2, c(Sam[1], Sam[2]))} 
		else if (length(Sam)==3) {Sister1(NM, Unsam[1]);  Rep_2_5(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3]))} else  Rep_2_6(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3], Sam[4]))} else
	{cbind(c(Missings[1], Missings[2], Missings[3], Missings[4]) ,c(sample.int(3,4, replace=T)))->>SU; S1<-SU[,1][SU[,2]==1]; S2<-SU[,1][SU[,2]==2];S3<-SU[,1][SU[,2]==3];
		if(length(S1)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1 );") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))}
		else  if(length(S2)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1 );") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}
		else  if(length(S3)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1 );") ; St[3]<-list(c(Inc3, S3[1], S3[2], S2[3], S2[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} 
		else  if(length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if(length(S2)==1) Sister1( Inc2, S2[1]) else Sister1( Inc3, S3[1])}
		else  if(length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			 if(length(S1)==1) Sister1( Inc1, S1[1]) else Sister1( Inc3, S3[1])}
		else  if(length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if(length(S1)==1) Sister1( Inc1, S1[1]) else Sister1( Inc2, S2[1])}
		else  if(length(S1)==2) {Sister2(Inc1, S1[1], S1[2]);  if (length(S2)==2) Sister2( Inc2, S2[1], S2[2]) else if  (length(S3)==2) Sister2( Inc3, S3[1], S3[2]) else {Sister1( Inc2, S2[1]); Sister1( Inc3, S3[1])}}
		else  if(length(S2)==2) {Sister2(Inc2, S2[1], S2[2]);  if (length(S3)==2) Sister2( Inc3, S3[1], S3[2]) else {Sister1( Inc1, S1[1]); Sister1( Inc3, S3[1])}}
		else {Sister2(Inc3, S3[1], S3[2]); Sister1( Inc1, S1[1]); Sister1( Inc2, S2[1])}}
 plot(PHYLO)}

Rep_3_8<-function  (Inc1, Inc2, Inc3, Missings) {
	if (is.monophyletic(PHYLO, c(Inc1, Inc2, Inc3 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1);") ; St[3]<-list(c(Inc1,Inc2, Inc3,  Missings[1], Missings[2], Missings[3], Missings[4], Missings[5]));PHYLO<<-drop.tip(PHYLO, Inc1) ;PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} else
	if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T||is.monophyletic(PHYLO,c(Inc1, Inc3))==T||is.monophyletic(PHYLO,c(Inc2, Inc3))==T) {{if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T) {Inc1->Mo1; Inc2->Mo2; Inc3->NM} else if (is.monophyletic(PHYLO,c(Inc1, Inc3))==T) {Inc1->Mo1; Inc3->Mo2; Inc2->NM} else {Inc2->Mo1; Inc3->Mo2; Inc1->NM}}
		cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5]),  c(sample.int(2,5, replace=T, prob = c(1,2))))->>SU; Sam<-SU[,1][SU[,2]==2]; Unsam<-SU[,1][SU[,2]==1]
		if(length(Sam)==0)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1 );") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM))}
		else if(length(Sam)==1) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM)); SisterOrSing1( c(Mo1, Mo2), Sam[1])}
		else if(length(Sam)==2) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM));  Rep_2_4(Mo1, Mo2, c(Sam[1], Sam[2]))} 
		else if(length(Sam)==3) {Sister2(NM, Unsam[1], Unsam[2]);  Rep_2_5(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3]))}
		else if(length(Sam)==4) {Sister1(NM, Unsam[1]);  Rep_2_6(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3], Sam[4]))} else  Rep_2_7(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5]))} else
	{cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5]) ,c(sample.int(3,5, replace=T)))->>SU; S1<-SU[,1][SU[,2]==1]; S2<-SU[,1][SU[,2]==2];S3<-SU[,1][SU[,2]==3];
		if(length(S1)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1 );") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))}
		else  if(length(S2)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1 );") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}
		else  if(length(S3)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1 );") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4], S3[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} 
		else  if(length(S1)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if(length(S2)==1) Sister1( Inc2, S2[1]) else Sister1( Inc3, S3[1])}
		else  if(length(S2)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			 if(length(S1)==1) Sister1( Inc1, S1[1]) else Sister1( Inc3, S3[1])}
		else  if(length(S3)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if(length(S1)==1) Sister1( Inc1, S1[1]) else Sister1( Inc2, S2[1])}
		else  if(length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if (length(S2)==2) Sister2( Inc2, S2[1], S2[2]) else if (length(S3)==2) Sister2( Inc3, S3[1], S3[2]) else {Sister1( Inc2, S2[1]); Sister1( Inc3, S3[1])}}
		else  if(length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			if (length(S1)==2) Sister2( Inc1, S1[1], S1[2]) else if (length(S3)==2) Sister2( Inc3, S3[1], S3[2]) else {Sister1( Inc1, S1[1]); Sister1( Inc3, S3[1])}}
		else  if(length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if (length(S1)==2) Sister2( Inc1, S1[1], S1[2]) else if (length(S2)==2) Sister2( Inc2, S2[1], S2[2]) else {Sister1( Inc1, S1[1]); Sister1( Inc2, S2[1])}}
		else  if(length(S1)==2&length(S2)==2) {Sister2(Inc1, S1[1], S1[2]); Sister2( Inc2, S2[1], S2[2]); Sister1( Inc3, S3[1])}  else
			 if(length(S1)==2&length(S3)==2) {Sister2(Inc1, S1[1], S1[2]); Sister2( Inc3, S3[1], S3[2]); Sister1( Inc2, S2[1])}  else
			{Sister2(Inc2, S2[1], S2[2]); Sister2( Inc3, S3[1], S3[2]); Sister1( Inc1, S2[1])} }
plot(PHYLO)}


Rep_3_9<-function  (Inc1, Inc2, Inc3, Missings) {
	if (is.monophyletic(PHYLO, c(Inc1, Inc2, Inc3 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1);") ; St[3]<-list(c(Inc1,Inc2, Inc3,  Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6]));PHYLO<<-drop.tip(PHYLO, Inc1) ;PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} else
	if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T||is.monophyletic(PHYLO,c(Inc1, Inc3))==T||is.monophyletic(PHYLO,c(Inc2, Inc3))==T) {{if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T) {Inc1->Mo1; Inc2->Mo2; Inc3->NM} else if (is.monophyletic(PHYLO,c(Inc1, Inc3))==T) {Inc1->Mo1; Inc3->Mo2; Inc2->NM} else {Inc2->Mo1; Inc3->Mo2; Inc1->NM}}
		cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6]) ,c(sample.int(2,6, replace=T, prob = c(1,2))))->>SU; Sam<-SU[,1][SU[,2]==2]; Unsam<-SU[,1][SU[,2]==1]
 		if(length(Sam)==0)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1 );") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5], Unsam[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM))}
		else if(length(Sam)==1) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM)); SisterOrSing1( c(Mo1, Mo2), Sam[1])}
		else if(length(Sam)==2) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM));  Rep_2_4(Mo1, Mo2, c(Sam[1], Sam[2]))} 
		else if(length(Sam)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM));  Rep_2_5(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3]))} 
		else if(length(Sam)==4) {Sister2(NM, Unsam[1], Unsam[2]);  Rep_2_6(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3], Sam[4]))}
		else if(length(Sam)==5) {Sister1(NM, Unsam[1]);  Rep_2_7(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5]))} else  Rep_2_8(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5], Sam[6]))} else
	{cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6]) ,c(sample.int(3,6, replace=T)))->>SU; S1<-SU[,1][SU[,2]==1]; S2<-SU[,1][SU[,2]==2];S3<-SU[,1][SU[,2]==3];
		if(length(S1)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1 );") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))}
		else  if(length(S2)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1 );") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5], S2[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}
		else  if(length(S3)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1 );") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4], S3[5], S3[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} 
		else  if(length(S1)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if(length(S2)==1) Sister1( Inc2, S2[1]) else Sister1( Inc3, S3[1])}
		else  if(length(S2)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			 if(length(S1)==1) Sister1( Inc1, S1[1]) else Sister1( Inc3, S3[1])}
		else  if(length(S3)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4], S3[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if(length(S1)==1) Sister1( Inc1, S1[1]) else Sister1( Inc2, S2[1])}
		else  if(length(S1)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if (length(S2)==2) Sister2( Inc2, S2[1], S2[2]) else if (length(S3)==2) Sister2( Inc3, S3[1], S3[2]) else {Sister1( Inc2, S2[1]); Sister1( Inc3, S3[1])}}
		else  if(length(S2)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			if (length(S1)==2) Sister2( Inc1, S1[1], S1[2]) else if (length(S3)==2) Sister2( Inc3, S3[1], S3[2]) else {Sister1( Inc1, S1[1]); Sister1( Inc3, S3[1])}}
		else  if(length(S3)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if (length(S1)==2) Sister2( Inc1, S1[1], S1[2]) else if (length(S2)==2) Sister2( Inc2, S2[1], S2[2]) else {Sister1( Inc1, S1[1]); Sister1( Inc2, S2[1])}}
		else  if(length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if (length(S2)==3) {St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}
			else if (length(S3)==3) {St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}
			else if (length(S2)==2) {Sister2( Inc2, S2[1], S2[2]); Sister1( Inc3, S3[1])}
			else {Sister2( Inc3, S3[1], S3[2]); Sister1( Inc2, S2[1])}}
		else  if(length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			if (length(S3)==3) {St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}
			else if (length(S1)==2) {Sister2( Inc1, S1[1], S1[2]); Sister1( Inc3, S3[1])}
			else {Sister2( Inc3, S3[1], S3[2]); Sister1( Inc1, S1[1])}}
		else  if(length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if (length(S1)==2) {Sister2( Inc1, S1[1], S1[2]); Sister1( Inc2, S2[1])}
			else  {Sister2( Inc2, S2[1], S2[2]); Sister1( Inc1, S1[1])}}
		else  {Sister2(Inc1, S1[1], S1[2]); Sister2( Inc2, S2[1], S2[2]); Sister2( Inc3, S3[1], S3[2])}}
  plot(PHYLO)}

Rep_3_10<-function  (Inc1, Inc2, Inc3, Missings) {
	if (is.monophyletic(PHYLO, c(Inc1, Inc2, Inc3 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1);") ; St[3]<-list(c(Inc1,Inc2, Inc3,  Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6], Missings[7]));PHYLO<<-drop.tip(PHYLO, Inc1) ;PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} else
	if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T||is.monophyletic(PHYLO,c(Inc1, Inc3))==T||is.monophyletic(PHYLO,c(Inc2, Inc3))==T) {{if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T) {Inc1->Mo1; Inc2->Mo2; Inc3->NM} else if (is.monophyletic(PHYLO,c(Inc1, Inc3))==T) {Inc1->Mo1; Inc3->Mo2; Inc2->NM} else {Inc2->Mo1; Inc3->Mo2; Inc1->NM}}
		cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6], Missings[7]) ,c(sample.int(2,7, replace=T, prob = c(1,2))))->>SU; Sam<-SU[,1][SU[,2]==2]; Unsam<-SU[,1][SU[,2]==1];
 		if(length(Sam)==0)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1 );") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5], Unsam[6], Unsam[7])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM))}
		else if(length(Sam)==1) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5], Unsam[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM)); SisterOrSing1( c(Mo1, Mo2), Sam[1])}
		else if(length(Sam)==2) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM));  Rep_2_4(Mo1, Mo2, c(Sam[1], Sam[2]))} 
		else if(length(Sam)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM));  Rep_2_5(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3]))} 
		else if(length(Sam)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM));  Rep_2_6(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3], Sam[4]))} 
		else if(length(Sam)==5) {Sister2(NM, Unsam[1], Unsam[2]);  Rep_2_7(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5]))}
		else if(length(Sam)==6) {Sister1(NM, Unsam[1]);  Rep_2_8(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5], Sam[6]))} else  Rep_2_9(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5], Sam[6], Sam[7]))} else
	{cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6], Missings[7]) ,c(sample.int(3,7, replace=T)))->>SU; S1<-SU[,1][SU[,2]==1]; S2<-SU[,1][SU[,2]==2];S3<-SU[,1][SU[,2]==3]
		if(length(S1)==7) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1 );") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6], S1[7])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))}
		else  if(length(S2)==7) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1 );") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5], S2[6], S2[7])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}
		else  if(length(S3)==7) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1 );") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4], S3[5], S3[6], S3[7])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} 
		else  if(length(S1)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if(length(S2)==1) Sister1( Inc2, S2[1]) else Sister1( Inc3, S3[1])}
		else  if(length(S2)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5], S2[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			 if(length(S1)==1) Sister1( Inc1, S1[1]) else Sister1( Inc3, S3[1])}
		else  if(length(S3)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4], S3[5], S3[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if(length(S1)==1) Sister1( Inc1, S1[1]) else Sister1( Inc2, S2[1])}
		else  if(length(S1)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if (length(S2)==2) Sister2( Inc2, S2[1], S2[2]) else if (length(S3)==2) Sister2( Inc3, S3[1], S3[2]) else {Sister1( Inc2, S2[1]); Sister1( Inc3, S3[1])}}
		else  if(length(S2)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			if (length(S1)==2) Sister2( Inc1, S1[1], S1[2]) else if (length(S3)==2) Sister2( Inc3, S3[1], S3[2]) else {Sister1( Inc1, S1[1]); Sister1( Inc3, S3[1])}}
		else  if(length(S3)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4], S3[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if (length(S1)==2) Sister2( Inc1, S1[1], S1[2]) else if (length(S2)==2) Sister2( Inc2, S2[1], S2[2]) else {Sister1( Inc1, S1[1]); Sister1( Inc2, S2[1])}}
		else  if(length(S1)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if (length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}
			else if (length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}
			else if (length(S2)==2)  {Sister2( Inc2, S2[1], S2[2]); Sister1( Inc3, S3[1])} 
			else {Sister2( Inc3, S3[1], S3[2]); Sister1( Inc2, S2[1])}}
		else  if(length(S2)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			if (length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))}
			else if (length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}
			else if (length(S1)==2)  {Sister2( Inc1, S1[1], S1[2]); Sister1( Inc3, S3[1])} 
			else {Sister2( Inc3, S3[1], S3[2]); Sister1( Inc1, S1[1])}}
		else  if(length(S3)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if (length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))}
			else if (length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}
			else if (length(S1)==2)  {Sister2( Inc1, S1[1], S1[2]); Sister1( Inc2, S3[1])} 
			else {Sister2( Inc2, S2[1], S2[2]); Sister1( Inc1, S1[1])}}
		else  if(length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if (length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); Sister1( Inc3, S3[1])}
			else if (length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3)); Sister1( Inc2, S2[1])}
			else {Sister2( Inc2, S2[1], S2[2]); Sister2( Inc3, S3[1], S3[2])}}
		else  if(length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			 if (length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3)); Sister1( Inc1, S1[1])}
			else {Sister2( Inc1, S1[1], S1[2]); Sister2( Inc3, S3[1], S3[2])}}
		else {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); Sister2( Inc1, S1[1], S1[2]); Sister2( Inc2, S2[1])}}
plot(PHYLO)}


Rep_3_11<-function  (Inc1, Inc2, Inc3, Missings) {
	if (is.monophyletic(PHYLO, c(Inc1, Inc2, Inc3 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1);") ; St[3]<-list(c(Inc1,Inc2, Inc3,  Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6], Missings[7], Missings[8]));PHYLO<<-drop.tip(PHYLO, Inc1) ;PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} else
	if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T||is.monophyletic(PHYLO,c(Inc1, Inc3))==T||is.monophyletic(PHYLO,c(Inc2, Inc3))==T) {{if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T) {Inc1->Mo1; Inc2->Mo2; Inc3->NM} else if (is.monophyletic(PHYLO,c(Inc1, Inc3))==T) {Inc1->Mo1; Inc3->Mo2; Inc2->NM} else {Inc2->Mo1; Inc3->Mo2; Inc1->NM}}
		cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6], Missings[7], Missings[8]) ,c(sample.int(2,8, replace=T, prob = c(1,2))))->>SU; Sam<-SU[,1][SU[,2]==2]; Unsam<-SU[,1][SU[,2]==1];
 		if(length(Sam)==0)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5], Unsam[6], Unsam[7], Unsam[8])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM))}
		else if(length(Sam)==1) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5], Unsam[6], Unsam[7])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM)); SisterOrSing1( c(Mo1, Mo2), Sam[1])}
		else if(length(Sam)==2) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5], Unsam[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM));  Rep_2_4(Mo1, Mo2, c(Sam[1], Sam[2]))} 
		else if(length(Sam)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM));  Rep_2_5(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3]))} 
		else if(length(Sam)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM));  Rep_2_6(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3], Sam[4]))} 
		else if(length(Sam)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM));  Rep_2_7(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5]))}
		else if(length(Sam)==6) {Sister2(NM, Unsam[1], Unsam[2]);  Rep_2_8(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5], Sam[6]))} 
		else if(length(Sam)==7) {Sister1(NM, Unsam[1]); Rep_2_9(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5], Sam[6], Sam[7]))} else Rep_2_10(Mo1, Mo2, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5], Sam[6], Sam[7], Sam[8]))} 
	else {cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6], Missings[7], Missings[8]) ,c(sample.int(3,8, replace=T)))->>SU; S1<-SU[,1][SU[,2]==1]; S2<-SU[,1][SU[,2]==2];S3<-SU[,1][SU[,2]==3]
		if(length(S1)==8) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1 );") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6], S1[7], S1[8])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))}
		else  if(length(S2)==8) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1 );") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5], S2[6], S2[7], S2[8])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}
		else  if(length(S3)==8) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1 );") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4], S3[5], S3[6], S3[7], S3[8])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} 
		else  if(length(S1)==7) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6], S1[7])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if(length(S2)==1) Sister1( Inc2, S2[1]) else Sister1( Inc3, S3[1])}
		else  if(length(S2)==7) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5], S2[6], S2[7])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			 if(length(S1)==1) Sister1( Inc1, S1[1]) else Sister1( Inc3, S3[1])}
		else  if(length(S3)==7) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4], S3[5], S3[6], S3[7])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if(length(S1)==1) Sister1( Inc1, S1[1]) else Sister1( Inc2, S2[1])}
		else  if(length(S1)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if (length(S2)==2) Sister2( Inc2, S2[1], S2[2]) else if (length(S3)==2) Sister2( Inc3, S3[1], S3[2]) else {Sister1( Inc2, S2[1]); Sister1( Inc3, S3[1])}}
		else  if(length(S2)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5], S2[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			if (length(S1)==2) Sister2( Inc1, S1[1], S1[2]) else if (length(S3)==2) Sister2( Inc3, S3[1], S3[2]) else {Sister1( Inc1, S1[1]); Sister1( Inc3, S3[1])}}
		else  if(length(S3)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4], S3[5], S2[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if (length(S1)==2) Sister2( Inc1, S1[1], S1[2]) else if (length(S2)==2) Sister2( Inc2, S2[1], S2[2]) else {Sister1( Inc1, S1[1]); Sister1( Inc2, S2[1])}}
		else  if(length(S1)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if (length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}
			else if (length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}
			else if (length(S2)==2)  {Sister2( Inc2, S2[1], S2[2]); Sister1( Inc3, S3[1])} 
			else {Sister2( Inc3, S3[1], S3[2]); Sister1( Inc2, S2[1])}}
		else  if(length(S2)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			if (length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))}
			else if (length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}
			else if (length(S1)==2)  {Sister2( Inc1, S1[1], S1[2]); Sister1( Inc3, S3[1])} 
			else {Sister2( Inc3, S3[1], S3[2]); Sister1( Inc1, S1[1])}}
		else  if(length(S3)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4], S3[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if (length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))}
			else if (length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}
			else if (length(S1)==2)  {Sister2( Inc1, S1[1], S1[2]); Sister1( Inc2, S3[1])} 
			else {Sister2( Inc2, S2[1], S2[2]); Sister1( Inc1, S1[1])}}
		else  if(length(S1)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			 if (length(S2)==4) {St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}
			else if (length(S3)==4) {St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}
			else if (length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); Sister1(Inc3, S3[1])}			
			else if (length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3)); Sister1(Inc2, S2[1])}			
			else {Sister2( Inc2, S2[1], S2[2]); Sister2( Inc3, S3[1], S3[2])}}
		else  if(length(S2)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ;St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			 if (length(S3)==4) {St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}
			else if (length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); Sister1(Inc3, S3[1])}			
			else if (length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3)); Sister1(Inc1, S1[1])}			
			else {Sister2( Inc1, S1[1], S1[2]); Sister2( Inc3, S3[1], S3[2])}}
		else  if(length(S3)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ;St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if (length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); Sister1(Inc2, S2[1])}			
			else if (length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); Sister1(Inc1, S1[1])}			
			else {Sister2( Inc1, S1[1], S1[2]); Sister2( Inc2, S2[1], S2[2])}}
		else if(length(S1)==2) {Sister2( Inc1, S1[1], S1[2]); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}
		else if(length(S2)==2) {Sister2( Inc2, S2[1], S2[2]); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}
		else {Sister2( Inc3, S3[1], S3[2]); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1)); St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}}
plot(PHYLO)}


Rep_3_15ODD<-function  (Inc1, Inc2, Inc3, Missings) {
Inc1_M<-sample.int(12,4); Rem<-c(1:12)[c(1:12)%in%Inc1_M==F]; Inc2_M<-Rem[sample.int(8,4)]; Inc3_M<-Rem[Rem%in%Inc2_M==F]
if (is.monophyletic(PHYLO,c(Inc1, Inc2, Inc3))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1, Tip15:1);") ; St[3]<-list(c(Inc1,Inc2, Inc3,  Missings[1], Missings[2], Missings[3], Missings[4], Missings[5],  Missings[6],  Missings[7],  Missings[8],  Missings[9],  Missings[10],  Missings[11],  Missings[12]));PHYLO<<-drop.tip(PHYLO, Inc1) ;PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} 
else if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1);") ; St[3]<-list(c(Inc1,Inc2, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]]));PHYLO<<-drop.tip(PHYLO, Inc1) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);"); St[3]<-list(c(Inc3, Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} 
else if (is.monophyletic(PHYLO,c(Inc1, Inc3))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1);") ; St[3]<-list(c(Inc1,Inc3, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]]));PHYLO<<-drop.tip(PHYLO, Inc1) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);"); St[3]<-list(c(Inc2, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} 
else if (is.monophyletic(PHYLO,c(Inc2, Inc3))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1);") ; St[3]<-list(c(Inc2,Inc3, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]]));PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);"); St[3]<-list(c(Inc1, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))} 
else { St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);"); St[3]<-list(c(Inc3, Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3));  St[3]<-list(c(Inc1, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1));  St[3]<-list(c(Inc2, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}}

Rep_3_18ODD<-function  (Inc1, Inc2, Inc3, Missings) {
Inc1_M<-sample.int(15,5); Rem<-c(1:15)[c(1:15)%in%Inc1_M==F]; Inc2_M<-Rem[sample.int(10,5)]; Inc3_M<-Rem[Rem%in%Inc2_M==F]
if (is.monophyletic(PHYLO,c(Inc1, Inc2, Inc3))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1, Tip15:1, Tip16:1, Tip17:1, Tip18:1);") ; St[3]<-list(c(Inc1,Inc2, Inc3,  Missings[1], Missings[2], Missings[3], Missings[4], Missings[5],  Missings[6],  Missings[7],  Missings[8],  Missings[9],  Missings[10],  Missings[11],  Missings[12],  Missings[13],  Missings[14],  Missings[15]));PHYLO<<-drop.tip(PHYLO, Inc1) ;PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} 
else if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1);") ; St[3]<-list(c(Inc1,Inc2, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]]));PHYLO<<-drop.tip(PHYLO, Inc1) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);"); St[3]<-list(c(Inc3, Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} 
else if (is.monophyletic(PHYLO,c(Inc1, Inc3))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1);") ; St[3]<-list(c(Inc1,Inc3, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]]));PHYLO<<-drop.tip(PHYLO, Inc1) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);"); St[3]<-list(c(Inc2, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} 
else if (is.monophyletic(PHYLO,c(Inc2, Inc3))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1);") ; St[3]<-list(c(Inc2,Inc3, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]], Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]]));PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);"); St[3]<-list(c(Inc1, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))} 
else { St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);"); St[3]<-list(c(Inc3, Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3));  St[3]<-list(c(Inc1, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1));  St[3]<-list(c(Inc2, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}}

Rep_3_21ODD<-function  (Inc1, Inc2, Inc3, Missings) {
Inc1_M<-sample.int(18,6); Rem<-c(1:18)[c(1:18)%in%Inc1_M==F]; Inc2_M<-Rem[sample.int(12,6)]; Inc3_M<-Rem[Rem%in%Inc2_M==F]
if (is.monophyletic(PHYLO,c(Inc1, Inc2, Inc3))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1, Tip15:1, Tip16:1, Tip17:1, Tip18:1, Tip19:1, Tip20:1, Tip21:1);") ; St[3]<-list(c(Inc1,Inc2, Inc3,  Missings[1], Missings[2], Missings[3], Missings[4], Missings[5],  Missings[6],  Missings[7],  Missings[8],  Missings[9],  Missings[10],  Missings[11],  Missings[12],  Missings[13],  Missings[14],  Missings[15],  Missings[16],  Missings[17],  Missings[18]));PHYLO<<-drop.tip(PHYLO, Inc1) ;PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} 
else if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1);") ; St[3]<-list(c(Inc1,Inc2, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc1_M[6]], Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]], Missings[Inc2_M[6]]));PHYLO<<-drop.tip(PHYLO, Inc1) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);"); St[3]<-list(c(Inc3, Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]], Missings[Inc3_M[6]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} 
else if (is.monophyletic(PHYLO,c(Inc1, Inc3))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1);") ; St[3]<-list(c(Inc1,Inc3, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc1_M[6]], Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]], Missings[Inc3_M[6]]));PHYLO<<-drop.tip(PHYLO, Inc1) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);"); St[3]<-list(c(Inc2, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]], Missings[Inc2_M[6]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} 
else if (is.monophyletic(PHYLO,c(Inc2, Inc3))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1);") ; St[3]<-list(c(Inc2,Inc3, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]], Missings[Inc2_M[6]], Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]], Missings[Inc3_M[6]]));PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);"); St[3]<-list(c(Inc1, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc1_M[6]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))} 
else { St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);"); St[3]<-list(c(Inc3, Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]], Missings[Inc3_M[6]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3));  St[3]<-list(c(Inc1, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc1_M[6]])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1));  St[3]<-list(c(Inc2, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]], Missings[Inc2_M[6]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}}

Rep_3_25ODD<-function  (Inc1, Inc2, Inc3, Missings) {
if (runif(1)<(1/3)) {In1<-Inc1; In2<-Inc2; In3<-Inc3} else if (runif(1)<(1/2)) {In2<-Inc1; In1<-Inc2; In3<-Inc3} else {In3<-Inc1; In2<-Inc2; In1<-Inc3}
Inc1_M<-sample.int(22,8); Rem<-c(1:22)[c(1:22)%in%Inc1_M==F]; Inc2_M<-Rem[sample.int(14,7)]; Inc3_M<-Rem[Rem%in%Inc2_M==F]
if (is.monophyletic(PHYLO,c(Inc1, Inc2, Inc3))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1, Tip15:1, Tip16:1, Tip17:1, Tip18:1, Tip19:1, Tip20:1, Tip21:1, Tip22:1, Tip23:1, Tip24:1, Tip25:1);") ; St[3]<-list(c(Inc1,Inc2, Inc3,  Missings[1], Missings[2], Missings[3], Missings[4], Missings[5],  Missings[6],  Missings[7],  Missings[8],  Missings[9],  Missings[10],  Missings[11],  Missings[12],  Missings[13],  Missings[14],  Missings[15],  Missings[16],  Missings[17],  Missings[18],  Missings[19],  Missings[20],  Missings[21],  Missings[22] ));PHYLO<<-drop.tip(PHYLO, Inc1) ;PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} 
else if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1, Tip15:1, Tip16:1, Tip17:1);") ; St[3]<-list(c(Inc1,Inc2, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc1_M[6]], Missings[Inc1_M[7]], Missings[Inc1_M[8]], Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]], Missings[Inc2_M[6]], Missings[Inc2_M[7]]));PHYLO<<-drop.tip(PHYLO, Inc1) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1);"); St[3]<-list(c(Inc3, Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]], Missings[Inc3_M[6]], Missings[Inc3_M[7]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} 
else if (is.monophyletic(PHYLO,c(Inc1, Inc3))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1, Tip15:1, Tip16:1, Tip17:1);") ; St[3]<-list(c(Inc1,Inc3, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc1_M[6]], Missings[Inc1_M[7]], Missings[Inc1_M[8]], Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]], Missings[Inc3_M[6]], Missings[Inc3_M[7]]));PHYLO<<-drop.tip(PHYLO, Inc1) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1);"); St[3]<-list(c(Inc2, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]], Missings[Inc2_M[6]], Missings[Inc2_M[7]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} 
else if (is.monophyletic(PHYLO,c(Inc2, Inc3))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1, Tip15:1, Tip16:1);") ; St[3]<-list(c(Inc2,Inc3, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]], Missings[Inc2_M[6]], Missings[Inc1_M[7]], Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]], Missings[Inc3_M[6]], Missings[Inc3_M[7]]));PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1);"); St[3]<-list(c(Inc1, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc1_M[6]], Missings[Inc1_M[7]], Missings[Inc1_M[8]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))} 
else { St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1);"); St[3]<-list(c(Inc3, Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]], Missings[Inc3_M[6]], Missings[Inc3_M[7]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3));  St[3]<-list(c(Inc2, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]], Missings[Inc2_M[6]], Missings[Inc2_M[7]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); 
St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1);"); St[3]<-list(c(Inc1, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc1_M[6]], Missings[Inc1_M[7]], Missings[Inc1_M[8]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))}}

Rep_3_33ODD<-function  (Inc1, Inc2, Inc3, Missings) {
Inc1_M<-sample.int(30,10); Rem<-c(1:30)[c(1:30)%in%Inc1_M==F]; Inc2_M<-Rem[sample.int(20,10)]; Inc3_M<-Rem[Rem%in%Inc2_M==F]
if (is.monophyletic(PHYLO,c(Inc1, Inc2, Inc3))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1, Tip15:1, Tip16:1, Tip17:1, Tip18:1, Tip19:1, Tip20:1, Tip21:1, Tip22:1, Tip23:1, Tip24:1, Tip25:1, Tip26:1, Tip27:1, Tip28:1, Tip29:1, Tip30:1, Tip31:1, Tip32:1, Tip33:1);") ; St[3]<-list(c(Inc1,Inc2, Inc3,  Missings[1], Missings[2], Missings[3], Missings[4], Missings[5],  Missings[6],  Missings[7],  Missings[8],  Missings[9],  Missings[10],  Missings[11],  Missings[12],  Missings[13],  Missings[14],  Missings[15],  Missings[16],  Missings[17],  Missings[18],  Missings[19],  Missings[20],  Missings[21],  Missings[22],  Missings[23],  Missings[24],  Missings[25],  Missings[26],  Missings[27],  Missings[28],  Missings[29],  Missings[30]));PHYLO<<-drop.tip(PHYLO, Inc1) ;PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} 
else if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1, Tip15:1, Tip16:1, Tip17:1, Tip18:1, Tip19:1, Tip20:1, Tip21:1);") ; St[3]<-list(c(Inc1,Inc2, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc1_M[6]], Missings[Inc1_M[7]], Missings[Inc1_M[8]], Missings[Inc1_M[9]], Missings[Inc1_M[10]], Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]], Missings[Inc2_M[6]], Missings[Inc2_M[7]], Missings[Inc2_M[8]], Missings[Inc2_M[9]], Missings[Inc2_M[10]]))
PHYLO<<-drop.tip(PHYLO, Inc1) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1);"); St[3]<-list(c(Inc3, Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]], Missings[Inc3_M[6]], Missings[Inc3_M[7]], Missings[Inc3_M[8]], Missings[Inc3_M[9]], Missings[Inc3_M[10]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))} 
else if (is.monophyletic(PHYLO,c(Inc1, Inc3))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1, Tip15:1, Tip16:1, Tip17:1, Tip18:1, Tip19:1, Tip20:1, Tip21:1);") ; St[3]<-list(c(Inc1,Inc3, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc1_M[6]], Missings[Inc1_M[7]], Missings[Inc1_M[8]], Missings[Inc1_M[9]], Missings[Inc1_M[10]], Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]], Missings[Inc3_M[6]], Missings[Inc3_M[7]], Missings[Inc3_M[8]], Missings[Inc3_M[9]], Missings[Inc3_M[10]]))
PHYLO<<-drop.tip(PHYLO, Inc1) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1);"); St[3]<-list(c(Inc2, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]], Missings[Inc2_M[6]], Missings[Inc3_M[7]], Missings[Inc3_M[8]], Missings[Inc3_M[9]], Missings[Inc3_M[10]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))} 
else if (is.monophyletic(PHYLO,c(Inc2, Inc3))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1, Tip12:1, Tip13:1, Tip14:1, Tip15:1, Tip16:1, Tip17:1, Tip18:1, Tip19:1, Tip20:1, Tip21:1);") ; St[3]<-list(c(Inc2,Inc3, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]], Missings[Inc2_M[6]], Missings[Inc2_M[7]], Missings[Inc2_M[8]], Missings[Inc2_M[9]], Missings[Inc2_M[10]], Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]], Missings[Inc3_M[6]], Missings[Inc3_M[7]], Missings[Inc3_M[8]], Missings[Inc3_M[9]], Missings[Inc3_M[10]]))
PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3)); St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1);"); St[3]<-list(c(Inc1, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc1_M[6]], Missings[Inc3_M[7]], Missings[Inc3_M[8]], Missings[Inc3_M[9]], Missings[Inc3_M[10]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))} 
else { St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1);"); St[3]<-list(c(Inc3, Missings[Inc3_M[1]], Missings[Inc3_M[2]], Missings[Inc3_M[3]], Missings[Inc3_M[4]], Missings[Inc3_M[5]], Missings[Inc3_M[6]], Missings[Inc3_M[7]], Missings[Inc3_M[8]], Missings[Inc3_M[9]], Missings[Inc3_M[10]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3));  St[3]<-list(c(Inc1, Missings[Inc1_M[1]], Missings[Inc1_M[2]], Missings[Inc1_M[3]], Missings[Inc1_M[4]], Missings[Inc1_M[5]], Missings[Inc1_M[6]], Missings[Inc1_M[7]], Missings[Inc1_M[8]], Missings[Inc1_M[9]], Missings[Inc1_M[10]])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1));  St[3]<-list(c(Inc2, Missings[Inc2_M[1]], Missings[Inc2_M[2]], Missings[Inc2_M[3]], Missings[Inc2_M[4]], Missings[Inc2_M[5]], Missings[Inc2_M[6]], Missings[Inc2_M[7]], Missings[Inc2_M[8]], Missings[Inc2_M[9]], Missings[Inc2_M[10]]));  PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}}

Rep_4_8<-function  (Inc1, Inc2, Inc3, Inc4, Missings) {
	 if (is.monophyletic(PHYLO,c(Inc1, Inc2, Inc3, Inc4 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1);") ; St[3]<-list(c(Inc1,Inc2, Inc3,  Inc4, Missings[1], Missings[2], Missings[3], Missings[4]));PHYLO<<-drop.tip(PHYLO, Inc1) ;PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-drop.tip(PHYLO, Inc3) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))} 
	else if (is.monophyletic(PHYLO,c(Inc2, Inc3, Inc1))==T||is.monophyletic(PHYLO,c(Inc1, Inc2, Inc4))==T||is.monophyletic(PHYLO,c(Inc1, Inc3, Inc4))==T||is.monophyletic(PHYLO,c(Inc2, Inc3, Inc4))==T)  
		{cbind(c(Missings[1], Missings[2], Missings[3], Missings[4]) ,c(sample.int(2,4, replace=T, prob = c(1,3))))->>SU; Sam<-SU[,1][SU[,2]==2]; Unsam<-SU[,1][SU[,2]==1]
		if (is.monophyletic(PHYLO,c(Inc1, Inc2, Inc3))==T) {Inc1->Mo1; Inc2->Mo2; Inc3->Mo3; Inc4->>NM} else if  (is.monophyletic(PHYLO,c(Inc1, Inc2, Inc4))==T) {Inc1->Mo1; Inc2->Mo2; Inc4->Mo3; Inc3->NM}  else if (is.monophyletic(PHYLO,c(Inc1, Inc3, Inc4))==T) {Inc1->Mo1; Inc3->Mo2; Inc4->Mo3; Inc2->NM} else {Inc2->Mo1; Inc3->Mo2; Inc4->Mo3; Inc1->NM}
		if(length(Sam)==0)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM))}
		else if(length(Sam)==1) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM)); SisterOrSing1( c(Mo1, Mo2, Mo3), Sam[1])}
		else if(length(Sam)==2) {Sister2(NM,  Unsam[1], Unsam[2]); Start<-c(Mo1, Mo2, Mo3); MIS<-c(Sam[1], Sam[2]); MIS1<-MIS[sample.int(2, 1)]; SisterOrSing1(Start, MIS1); MIS<-MIS[MIS%in%MIS1==F]; Start<-c(Start, MIS1); SisterOrSing1(Start, MIS)} 
		else if(length(Sam)==3) {Sister1(NM, Unsam[1]); Rep_3_6(Mo1, Mo2, Mo3, c(Sam[1], Sam[2], Sam[3]))} else Rep_3_7(Mo1, Mo2, Mo3, c(Sam[1], Sam[2], Sam[3], Sam[4]))} 
	else if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T&is.monophyletic(PHYLO,c(Inc3, Inc4))==T||is.monophyletic(PHYLO,c(Inc1, Inc3))==T&is.monophyletic(PHYLO,c(Inc2, Inc4))==T||is.monophyletic(PHYLO,c(Inc1, Inc4))==T&is.monophyletic(PHYLO,c(Inc2, Inc3))==T) 
		{{if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T&is.monophyletic(PHYLO,c(Inc3, Inc4))==T) {Inc1->M11; Inc2->M12; Inc3->M21; Inc4->M22} else if (is.monophyletic(PHYLO,c(Inc1, Inc3))==T&is.monophyletic(PHYLO,c(Inc2, Inc4))==T)  {Inc1->M11; Inc3->M12; Inc2->M21; Inc4->M22}  else {Inc1->M11; Inc4->M12; Inc2->M21; Inc3->M22}}
		cbind(c(Missings[1], Missings[2], Missings[3], Missings[4]) ,c(sample.int(2,4, replace=T)))->>SU; Sam<-SU[,1][SU[,2]==2]; Unsam<-SU[,1][SU[,2]==1];
		if(length(Sam)==0) Rep_2_6(M21, M22, c(Unsam[1], Unsam[2], Unsam[3], Unsam[4]))
		else if (length(Sam)==4) Rep_2_6(M11, M12, c(Sam[1], Sam[2], Sam[3], Sam[4]))
		else if (length(Sam)==1) {Rep_2_5(M21, M22, c(Unsam[1], Unsam[2], Unsam[3])); SisterOrSing1( c(M11, M12), Sam[1])}
		else if (length(Sam)==3) {Rep_2_5(M11, M12, c(Sam[1], Sam[2], Sam[3])); SisterOrSing1( c(M21, M22), Unsam[1])}
		else {Rep_2_4(M11, M12, c(Sam[1], Sam[2])); Rep_2_4(M21, M22, c(Unsam[1], Unsam[2]))}}
	else if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T||is.monophyletic(PHYLO,c(Inc1, Inc3))==T||is.monophyletic(PHYLO,c(Inc1, Inc4))==T||is.monophyletic(PHYLO,c(Inc2, Inc3))==T||is.monophyletic(PHYLO,c(Inc2, Inc4))==T||is.monophyletic(PHYLO,c(Inc3, Inc4))==T)
		{{if (is.monophyletic(PHYLO,c(Inc1, Inc2))==T) {Inc1->M1; Inc2->M2; Inc3->N1; Inc4->N2} else if (is.monophyletic(PHYLO,c(Inc1, Inc3))==T)  {Inc1->M1; Inc3->M2; Inc2->N1; Inc4->N2} else if (is.monophyletic(PHYLO,c(Inc1, Inc4))==T)  {Inc1->M1; Inc4->M2; Inc2->N1; Inc3->N2}
		 else if (is.monophyletic(PHYLO,c(Inc2, Inc3))==T)  {Inc2->M1; Inc3->M2; Inc1->N1; Inc4->N2} else if (is.monophyletic(PHYLO,c(Inc2, Inc4))==T)  {Inc2->M1; Inc4->M2; Inc1->N1; Inc3->N2} else  {Inc3->M1; Inc4->M2; Inc1->N1; Inc4->N2}}
		cbind(c(Missings[1], Missings[2], Missings[3], Missings[4]) ,c(sample.int(3,4, prob=c(1,1,2), replace=T)))->>SU; S1<-SU[,1][SU[,2]==1]; S2<-SU[,1][SU[,2]==2]; G<-SU[,1][SU[,2]==3]
		if(length(G)==4) Rep_2_6(M1, M2, c(G[1], G[2], G[3], G[4]))
		else  if(length(S1)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1))}
		else  if(length(S2)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(N2, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2))}
		else  if(length(G)==3) {Rep_2_5(M1, M2, c(G[1], G[2], G[3]));
			if (length(S1)==1) Sister1( N1, S1[1]) else  Sister1( N2, S2[1]) }
		else  if(length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1));
			if (length(S2)==1) Sister1( N2, S2[1]) else SisterOrSing1( c(M1, M2), G[1])}
		else  if(length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2));
			if (length(S1)==1) Sister1( N1, S1[1]) else SisterOrSing1( c(M1, M2), G[1])}
		else  if (length(G)==2) {Rep_2_4(M1, M2, c(G[1], G[2])); 
			if (length(S1)==2) Sister2( N1, S1[1], S1[2]) else if  (length(S2)==2)  Sister2( N2, S2[1], S2[2]) else {Sister1( N1, S1[1]); Sister1( N2, S2[1])}}
		else if (length(G)==1) { SisterOrSing1( c(M1, M2), G[1])
			if  (length(S1)==2) {Sister2( N1, S1[1], S1[2]);  Sister1( N2, S2[1])} else {Sister2( N2, S2[1], S2[2]);  Sister1( N1, S1[1])}}
		else  {Sister2( N1, S1[1], S1[2]);  Sister2( N2, S2[1], S2[2])}}
	else {cbind(c(Missings[1], Missings[2], Missings[3], Missings[4]) ,c(sample.int(4,4, replace=T)))->>SU; S1<-SU[,1][SU[,2]==1]; S2<-SU[,1][SU[,2]==2]; S3<-SU[,1][SU[,2]==3]; S4<-SU[,1][SU[,2]==4]
		if(length(S1)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))}		
		else if(length(S2)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}		
		else if(length(S3)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}		
		else if(length(S4)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc4, S4[1], S4[2], S4[3], S4[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))}		
		else if(length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if (length(S2)==1) Sister1( Inc2,  S2[1]) else if  (length(S3)==1) Sister1( Inc3,  S3[1]) else Sister1( Inc4,  S4[1])}
		else if(length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			if (length(S1)==1) Sister1( Inc1,  S1[1]) else if  (length(S3)==1) Sister1( Inc3,  S3[1]) else Sister1( Inc4,  S4[1])}
		else if(length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if (length(S1)==1) Sister1( Inc1,  S1[1]) else if  (length(S2)==1) Sister1( Inc2,  S2[1]) else  Sister1( Inc4,  S4[1])}
		else if(length(S4)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc4, S4[1], S4[2], S4[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))
			if (length(S1)==1) Sister1( Inc1,  S1[1]) else if  (length(S2)==1) Sister1( Inc2,  S2[1]) else Sister1( Inc3,  S3[1])}
		else if(length(S1)==2) {Sister2(Inc1, S1[1], S1[2]); if (length(S2)==2) Sister2( Inc2, S2[1], S2[2]) else if (length(S3)==2) Sister2(  Inc3, S3[1], S3[2]) else if (length(S4)==2) Sister2(  Inc4, S4[1], S4[2])
			else if (length(S2)==0) {Sister1 (PHYLO, Inc3, S3[1]); Sister1 (PHYLO, Inc4, S4[1])} else if (length(S3)==0) {Sister1 (PHYLO, Inc2, S2[1]); Sister1 (PHYLO, Inc4, S4[1])} else {Sister1 (PHYLO, Inc2, S2[1]); Sister1 (PHYLO, Inc3, S3[1])}}
		else if(length(S2)==2) {Sister2( Inc2, S2[1], S2[2]); if (length(S3)==2) Sister2(  Inc3, S3[1], S3[2]) else if (length(S4)==2) Sister2(  Inc4, S4[1], S4[2])
			else if (length(S1)==0) {Sister1 (PHYLO, Inc3, S3[1]); Sister1 (PHYLO, Inc4, S4[1])} else if (length(S3)==0) {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc4, S4[1])} else {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc3, S3[1])}}
		else if(length(S3)==2) {Sister2(  Inc3, S3[1], S3[2]); if (length(S4)==2) Sister2(  Inc4, S4[1], S4[2])
			else if (length(S1)==0) {Sister1 (PHYLO, Inc2, S2[1]); Sister1 (PHYLO, Inc4, S4[1])} else if (length(S2)==0) {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc4, S4[1])} else {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc2, S2[1])}}
		else if(length(S4)==2) {Sister2(  Inc4, S4[1], S4[2])
			if (length(S1)==0) {Sister1 (PHYLO, Inc2, S2[1]); Sister1 (PHYLO, Inc3, S3[1])} else if (length(S2)==0) {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc3, S3[1])} else {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc2, S2[1])}}
		else {Sister1(Inc1,  S1[1]);  Sister1( Inc2,  S2[1]);  Sister1( Inc3,  S3[1]); Sister1( Inc4,  S4[1])}}   
plot(PHYLO)}

Rep_4_9<-function  (Inc1, Inc2, Inc3, Inc4, Missings) {
	 if (is.monophyletic(PHYLO, c(Inc1, Inc2, Inc3, Inc4 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1);") ; St[3]<-list(c(Inc1,Inc2, Inc3,  Inc4, Missings[1], Missings[2], Missings[3], Missings[4], Missings[5]));PHYLO<<-drop.tip(PHYLO, Inc1) ;PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-drop.tip(PHYLO, Inc3) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))} 
	else  if (is.monophyletic(PHYLO, c(Inc2, Inc3, Inc1))==T||is.monophyletic(PHYLO, c(Inc1, Inc2, Inc4))==T||is.monophyletic(PHYLO, c(Inc1, Inc3, Inc4))==T||is.monophyletic(PHYLO, c(Inc2, Inc3, Inc4))==T)  
		{cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5]) ,c(sample.int(2,5, replace=T, prob = c(1,3))))->>SU; Sam<-SU[,1][SU[,2]==2]; Unsam<-SU[,1][SU[,2]==1]
		if (is.monophyletic(PHYLO, c(Inc1, Inc2, Inc3))==T) {Inc1->Mo1; Inc2->Mo2; Inc3->Mo3; Inc4->>NM} else if  (is.monophyletic(PHYLO, c(Inc1, Inc2, Inc4))==T) {Inc1->Mo1; Inc2->Mo2; Inc4->Mo3; Inc3->NM}  else if (is.monophyletic(PHYLO, c(Inc1, Inc3, Inc4))==T) {Inc1->Mo1; Inc3->Mo2; Inc4->Mo3; Inc2->NM} else {Inc2->Mo1; Inc3->Mo2; Inc4->Mo3; Inc1->NM}
		{if(length(Sam)==0)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM))}
		else if(length(Sam)==1) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM)); SisterOrSing1( c(Mo1, Mo2, Mo3), Sam[1])}
		else if(length(Sam)==2) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3]));  Start<-c(Mo1, Mo2, Mo3); MIS<-c(Sam[1], Sam[2]); MIS1<-MIS[sample.int(2, 1)]; SisterOrSing1(Start, MIS1); MIS<-MIS[MIS%in%MIS1==F]; Start<-c(Start, MIS1); SisterOrSing1(Start, MIS)} 
		else if(length(Sam)==3) {Sister2( NM,  Unsam[1], Unsam[2]);  Rep_3_6(Mo1, Mo2, Mo3, c(Sam[1], Sam[2], Sam[3]))}
		else if(length(Sam)==4) {Sister1( NM, Unsam[1]); Rep_3_7(Mo1, Mo2, Mo3, c(Sam[1], Sam[2], Sam[3], Sam[4]))} else Rep_3_8(Mo1, Mo2, Mo3, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5]))}}
	else if (is.monophyletic(PHYLO, c(Inc1, Inc2))==T&is.monophyletic(PHYLO, c(Inc3, Inc4))==T||is.monophyletic(PHYLO, c(Inc1, Inc3))==T&is.monophyletic(PHYLO, c(Inc2, Inc4))==T||is.monophyletic(PHYLO, c(Inc1, Inc4))==T&is.monophyletic(PHYLO, c(Inc2, Inc3))==T) 
		{{if (is.monophyletic(PHYLO, c(Inc1, Inc2))==T&is.monophyletic(PHYLO, c(Inc3, Inc4))==T) {Inc1->M11; Inc2->M12; Inc3->M21; Inc4->M22} else if (is.monophyletic(PHYLO, c(Inc1, Inc3))==T&is.monophyletic(PHYLO, c(Inc2, Inc4))==T)  {Inc1->M11; Inc3->M12; Inc2->M21; Inc4->M22}  else {Inc1->M11; Inc4->M12; Inc2->M21; Inc3->M22}}
		cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5]) ,c(sample.int(2,5, replace=T)))->>SU; Sam<-SU[,1][SU[,2]==2]; Unsam<-SU[,1][SU[,2]==1];
		if(length(Sam)==0) Rep_2_7(M21, M22, c(Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5]))
		else if (length(Sam)==5) Rep_2_7(M11, M12, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5]))
		else if (length(Sam)==1) {Rep_2_6(M21, M22, c(Unsam[1], Unsam[2], Unsam[3], Unsam[4])); SisterOrSing1( c(M11, M12), Sam[1])}
		else if (length(Sam)==4) {Rep_2_6(M11, M12, c(Sam[1], Sam[2], Sam[3], Sam[4])); SisterOrSing1( c(M21, M22), Unsam[1])}
		else if (length(Sam)==3) {Rep_2_5(M11, M12, c(Sam[1], Sam[2], Sam[3])); Rep_2_4(M11, M12, c(Unsam[1], Unsam[2]))}
		else  {Rep_2_4(M11, M12, c(Sam[1], Sam[2])); Rep_2_5(M21, M22, c(Unsam[1], Unsam[2], Unsam[3]))}}
	else if (is.monophyletic(PHYLO, c(Inc1, Inc2))==T||is.monophyletic(PHYLO, c(Inc1, Inc3))==T||is.monophyletic(PHYLO, c(Inc1, Inc4))==T||is.monophyletic(PHYLO, c(Inc2, Inc3))==T||is.monophyletic(PHYLO, c(Inc2, Inc4))==T||is.monophyletic(PHYLO, c(Inc3, Inc4))==T)
		{{if (is.monophyletic(PHYLO, c(Inc1, Inc2))==T) {Inc1->M1; Inc2->M2; Inc3->N1; Inc4->N2} else if (is.monophyletic(PHYLO, c(Inc1, Inc3))==T)  {Inc1->M1; Inc3->M2; Inc2->N1; Inc4->N2} else if (is.monophyletic(PHYLO, c(Inc1, Inc4))==T)  {Inc1->M1; Inc4->M2; Inc2->N1; Inc3->N2}
		 else if (is.monophyletic(PHYLO, c(Inc2, Inc3))==T)  {Inc2->M1; Inc3->M2; Inc1->N1; Inc4->N2} else if (is.monophyletic(PHYLO, c(Inc2, Inc4))==T)  {Inc2->M1; Inc4->M2; Inc1->N1; Inc3->N2} else  {Inc3->M1; Inc4->M2; Inc1->N1; Inc4->N2}}
		cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5]) ,c(sample.int(3,5, prob=c(1,1,2), replace=T)))->>SU; S1<-SU[,1][SU[,2]==1]; S2<-SU[,1][SU[,2]==2]; G<-SU[,1][SU[,2]==3]
		if(length(G)==5) Rep_2_7(M1, M2, c(G[1], G[2], G[3], G[4], G[5]))
		else  if(length(S1)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3], S1[4], S1[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1))}
		else  if(length(S2)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3], S2[4], S2[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2))}
		else  if(length(G)==4) {Rep_2_6(M1, M2, c(G[1], G[2], G[3], G[4]));
			if (length(S1)==1) Sister1( N1, S1[1]) else  Sister1( N2, S2[1]) }
		else  if(length(S1)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1));
			if (length(S2)==1) Sister1( N2, S2[1]) else SisterOrSing1( c(M1, M2), G[1])}
		else  if(length(S2)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3], S2[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2));
			if (length(S1)==1) Sister1( N1, S1[1]) else SisterOrSing1( c(M1, M2), G[1])}
		else  if (length(G)==3) {Rep_2_5(M1, M2, c(G[1], G[2], G[3])); 
			if (length(S1)==2) Sister2( N1, S1[1], S1[2]) else if  (length(S2)==2)  Sister2( N2, S2[1], S2[2]) else {Sister1( N1, S1[1]); Sister1( N2, S2[1])}}
		else if(length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1))
			if (length(S2)==2) Sister2( N2, S2[1], S2[2]) else if  (length(G)==2)  Rep_2_4(M1, M2, c(G[1], G[2])) else {Sister1( N2, S2[1]); SisterOrSing1( c(M1, M2), G[1])}}
		else if(length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2))
			if (length(S1)==2) Sister2( N1, S1[1], S1[2]) else if  (length(G)==2)  Rep_2_4(M1, M2, c(G[1], G[2])) else {Sister1( N1, S1[1]); SisterOrSing1( c(M1, M2), G[1])}}
		else if (length(G)==1)  {SisterOrSing1( c(M1, M2), G[1]); Sister2( N1, S1[1], S1[2]); Sister2( N2, S2[1], S2[2])}
		else if (length(S1)==1) {Rep_2_4(M1, M2, c(G[1], G[2])); Sister2( N2, S2[1], S2[2]); Sister1( N1, S1[1])}
		else {Rep_2_4(M1, M2, c(G[1], G[2])); Sister2( N1, S1[1], S1[2]); Sister1( N2, S2[1])}}
	else {cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5]) ,c(sample.int(4,5, replace=T)))->>SU; S1<-SU[,1][SU[,2]==1]; S2<-SU[,1][SU[,2]==2]; S3<-SU[,1][SU[,2]==3]; S4<-SU[,1][SU[,2]==4]
		if(length(S1)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))}		
		else if(length(S2)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}		
		else if(length(S3)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4], S3[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}		
		else if(length(S4)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc4, S4[1], S4[2], S4[3], S4[4], S4[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))}		
		else if(length(S1)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if (length(S2)==1) Sister1( Inc2,  S2[1]) else if  (length(S3)==1) Sister1( Inc3,  S3[1]) else Sister1( Inc4,  S4[1])}
		else if(length(S2)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			if (length(S1)==1) Sister1( Inc1,  S1[1]) else if  (length(S3)==1) Sister1( Inc3,  S3[1]) else Sister1( Inc4,  S4[1])}
		else if(length(S3)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if (length(S1)==1) Sister1( Inc1,  S1[1]) else if  (length(S2)==1) Sister1( Inc2,  S2[1]) else  Sister1( Inc4,  S4[1])}
		else if(length(S4)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc4, S4[1], S4[2], S4[3], S4[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))
			if (length(S1)==1) Sister1( Inc1,  S1[1]) else if  (length(S2)==1) Sister1( Inc2,  S2[1]) else Sister1( Inc3,  S3[1])}
		else if(length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if (length(S2)==2) Sister2( Inc2, S2[1], S2[2]) else if (length(S3)==2) Sister2(  Inc3, S3[1], S3[2]) else if (length(S4)==2) Sister2(  Inc4, S4[1], S4[2])
			else if (length(S2)==0) {Sister1 (PHYLO, Inc3, S3[1]); Sister1 (PHYLO, Inc4, S4[1])} else if (length(S3)==0) {Sister1 (PHYLO, Inc2, S2[1]); Sister1 (PHYLO, Inc4, S4[1])} else {Sister1 (PHYLO, Inc2, S2[1]); Sister1 (PHYLO, Inc3, S3[1])}}
		else if(length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			if (length(S1)==2) Sister2( Inc1, S1[1], S1[2]) else if (length(S3)==2) Sister2(  Inc3, S3[1], S3[2]) else if (length(S4)==2) Sister2(  Inc4, S4[1], S4[2])
			else if (length(S1)==0) {Sister1 (PHYLO, Inc3, S3[1]); Sister1 (PHYLO, Inc4, S4[1])} else if (length(S3)==0) {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc4, S4[1])} else {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc3, S3[1])}}
		else if(length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if (length(S1)==2) Sister2( Inc1, S1[1], S1[2]) else if (length(S2)==2) Sister2(  Inc2, S2[1], S2[2]) else if (length(S4)==2) Sister2(  Inc4, S4[1], S4[2])
			else if (length(S1)==0) {Sister1 (PHYLO, Inc2, S2[1]); Sister1 (PHYLO, Inc4, S4[1])} else if (length(S2)==0) {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc4, S4[1])} else {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc2, S2[1])}}
		else if(length(S4)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc4, S4[1], S4[2], S4[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))
			if (length(S1)==2) Sister2( Inc1, S1[1], S1[2]) else if (length(S2)==2) Sister2(  Inc2, S2[1], S2[2]) else if (length(S3)==2) Sister2(  Inc3, S3[1], S3[2])
			else if (length(S1)==0) {Sister1 (PHYLO, Inc2, S2[1]); Sister1 (PHYLO, Inc3, S3[1])} else if (length(S2)==0) {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc3, S3[1])} else {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc2, S2[1])}}
		else  if(length(S1)==2) {Sister2(  Inc1, S1[1], S1[2]); if(length(S2)==2) {Sister2(  Inc2, S2[1], S2[2]); if (length(S3)==1) Sister1(  Inc3, S3[1]) else Sister1(  Inc4, S4[1])} 
			else if(length(S3)==2) {Sister2(  Inc3, S3[1], S3[2]); if (length(S2)==1) Sister1(  Inc2, S2[1]) else Sister1(  Inc4, S4[1])}
			else if(length(S4)==2) {Sister2(  Inc4, S4[1], S4[2]); if (length(S2)==1) Sister1(  Inc2, S2[1]) else Sister1(  Inc3, S3[1])}
			else {Sister1( Inc2,  S2[1]);  Sister1( Inc3,  S3[1]);  Sister1( Inc4,  S4[1])}}
		else  if(length(S2)==2) {Sister2(  Inc2, S2[1], S2[2]); if(length(S3)==2) {Sister2(  Inc3, S3[1], S3[2]); if (length(S1)==1) Sister1(  Inc1, S1[1]) else Sister1(  Inc4, S4[1])}
			else if(length(S4)==2) {Sister2(  Inc4, S4[1], S4[2]); if (length(S1)==1) Sister1(  Inc1, S1[1]) else Sister1(  Inc3, S3[1])}
			else  {Sister1( Inc1,  S1[1]);  Sister1( Inc3,  S3[1]);  Sister1( Inc4,  S4[1])}}
		else if(length(S3)==2) {Sister2(  Inc3, S3[1], S3[2]); if(length(S4)==2) {Sister2(  Inc4, S4[1], S4[2]); if (length(S1)==1) Sister1(  Inc1, S1[1]) else Sister1(  Inc2, S2[1])}
			else  {Sister1( Inc1,  S1[1]);  Sister1( Inc2,  S2[1]);  Sister1( Inc4,  S4[1])}}
		else {Sister2(  Inc4, S4[1], S4[2]); Sister1( Inc1,  S1[1]);  Sister1( Inc2,  S2[1]);  Sister1( Inc3,  S3[1])}}
plot(PHYLO)}

Rep_4_10<-function  (Inc1, Inc2, Inc3, Inc4, Missings) {
	 if (is.monophyletic(PHYLO, c(Inc1, Inc2, Inc3, Inc4 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1);") ; St[3]<-list(c(Inc1,Inc2, Inc3,  Inc4, Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6]));PHYLO<<-drop.tip(PHYLO, Inc1) ;PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-drop.tip(PHYLO, Inc3) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))} 
	else  if (is.monophyletic(PHYLO, c(Inc2, Inc3, Inc1))==T||is.monophyletic(PHYLO, c(Inc1, Inc2, Inc4))==T||is.monophyletic(PHYLO, c(Inc1, Inc3, Inc4))==T||is.monophyletic(PHYLO, c(Inc2, Inc3, Inc4))==T)  
		{cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6]) ,c(sample.int(2,6, replace=T, prob = c(1,3))))->>SU; Sam<-SU[,1][SU[,2]==2]; Unsam<-SU[,1][SU[,2]==1]
		if (is.monophyletic(PHYLO, c(Inc1, Inc2, Inc3))==T) {Inc1->Mo1; Inc2->Mo2; Inc3->Mo3; Inc4->>NM} else if  (is.monophyletic(PHYLO, c(Inc1, Inc2, Inc4))==T) {Inc1->Mo1; Inc2->Mo2; Inc4->Mo3; Inc3->NM}  else if (is.monophyletic(PHYLO, c(Inc1, Inc3, Inc4))==T) {Inc1->Mo1; Inc3->Mo2; Inc4->Mo3; Inc2->NM} else {Inc2->Mo1; Inc3->Mo2; Inc4->Mo3; Inc1->NM}
		{if(length(Sam)==0)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5], Unsam[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM))}
		else if(length(Sam)==1) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM)); SisterOrSing1( c(Mo1, Mo2, Mo3), Sam[1])}
		else if(length(Sam)==2) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4]));  Start<-c(Mo1, Mo2, Mo3); MIS<-c(Sam[1], Sam[2]); MIS1<-MIS[sample.int(2, 1)]; SisterOrSing1(Start, MIS1); MIS<-MIS[MIS%in%MIS1==F]; Start<-c(Start, MIS1); SisterOrSing1(Start, MIS)} 
		else if(length(Sam)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3]));  Rep_3_6(Mo1, Mo2, Mo3, c(Sam[1], Sam[2], Sam[3]))}
		else if(length(Sam)==4) {Sister2( NM,  Unsam[1], Unsam[2]);  Rep_3_7(Mo1, Mo2, Mo3, c(Sam[1], Sam[2], Sam[3], Sam[4]))}
		else if(length(Sam)==5) {Sister1( NM, Unsam[1]); Rep_3_7(Mo1, Mo2, Mo3, c(Sam[1], Sam[2], Sam[3], Sam[4]))} else Rep_3_8(Mo1, Mo2, Mo3, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5]))}}
	else if (is.monophyletic(PHYLO, c(Inc1, Inc2))==T&is.monophyletic(PHYLO, c(Inc3, Inc4))==T||is.monophyletic(PHYLO, c(Inc1, Inc3))==T&is.monophyletic(PHYLO, c(Inc2, Inc4))==T||is.monophyletic(PHYLO, c(Inc1, Inc4))==T&is.monophyletic(PHYLO, c(Inc2, Inc3))==T) 
		{{if (is.monophyletic(PHYLO, c(Inc1, Inc2))==T&is.monophyletic(PHYLO, c(Inc3, Inc4))==T) {Inc1->M11; Inc2->M12; Inc3->M21; Inc4->M22} else if (is.monophyletic(PHYLO, c(Inc1, Inc3))==T&is.monophyletic(PHYLO, c(Inc2, Inc4))==T)  {Inc1->M11; Inc3->M12; Inc2->M21; Inc4->M22}  else {Inc1->M11; Inc4->M12; Inc2->M21; Inc3->M22}}
		cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6]) ,c(sample.int(2,6, replace=T)))->>SU; Sam<-SU[,1][SU[,2]==2]; Unsam<-SU[,1][SU[,2]==1];
		if(length(Sam)==0) Rep_2_8(M21, M22, c(Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5], Unsam[6]))
		else if (length(Sam)==6) Rep_2_8(M11, M12, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5], Sam[6]))
		else if (length(Sam)==1) {Rep_2_7(M21, M22, c(Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5])); SisterOrSing1( c(M11, M12), Sam[1])}
		else if (length(Sam)==5) {Rep_2_7(M11, M12, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5])); SisterOrSing1( c(M21, M22), Unsam[1])}
		else if (length(Sam)==4) {Rep_2_6(M11, M12, c(Sam[1], Sam[2], Sam[3], Sam[4])); Rep_2_4(M21, M22, c(Unsam[1], Unsam[2]))}
		else if (length(Sam)==2) {Rep_2_6(M21, M22, c(Unsam[1], Unsam[2], Unsam[3], Unsam[4])); Rep_2_4(M11, M12, c(Sam[1], Sam[2]))}
		else  {Rep_2_5(M11, M12, c(Sam[1], Sam[2], Sam[3])); Rep_2_5(M21, M22, c(Unsam[1], Unsam[2], Unsam[3]))}}
	else if (is.monophyletic(PHYLO, c(Inc1, Inc2))==T||is.monophyletic(PHYLO, c(Inc1, Inc3))==T||is.monophyletic(PHYLO, c(Inc1, Inc4))==T||is.monophyletic(PHYLO, c(Inc2, Inc3))==T||is.monophyletic(PHYLO, c(Inc2, Inc4))==T||is.monophyletic(PHYLO, c(Inc3, Inc4))==T)
		{{if (is.monophyletic(PHYLO, c(Inc1, Inc2))==T) {Inc1->M1; Inc2->M2; Inc3->N1; Inc4->N2} else if (is.monophyletic(PHYLO, c(Inc1, Inc3))==T)  {Inc1->M1; Inc3->M2; Inc2->N1; Inc4->N2} else if (is.monophyletic(PHYLO, c(Inc1, Inc4))==T)  {Inc1->M1; Inc4->M2; Inc2->N1; Inc3->N2}
		 else if (is.monophyletic(PHYLO, c(Inc2, Inc3))==T)  {Inc2->M1; Inc3->M2; Inc1->N1; Inc4->N2} else if (is.monophyletic(PHYLO, c(Inc2, Inc4))==T)  {Inc2->M1; Inc4->M2; Inc1->N1; Inc3->N2} else  {Inc3->M1; Inc4->M2; Inc1->N1; Inc4->N2}}
		cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6]) ,c(sample.int(3,6, prob=c(1,1,2), replace=T)))->>SU; S1<-SU[,1][SU[,2]==1]; S2<-SU[,1][SU[,2]==2]; G<-SU[,1][SU[,2]==3]
		if(length(G)==6) Rep_2_8(M1, M2, c(G[1], G[2], G[3], G[4], G[5], G[6]))
		else  if(length(S1)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1))}
		else  if(length(S2)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3], S2[4], S2[5], S2[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2))}
		else  if(length(G)==5) {Rep_2_7(M1, M2, c(G[1], G[2], G[3], G[4], G[5]));
			if (length(S1)==1) Sister1( N1, S1[1]) else  Sister1( N2, S2[1]) }
		else  if(length(S1)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3], S1[4], S1[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1));
			if (length(S2)==1) Sister1( N2, S2[1]) else SisterOrSing1( c(M1, M2), G[1])}
		else  if(length(S2)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3], S2[4], S2[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2));
			if (length(S1)==1) Sister1( N1, S1[1]) else SisterOrSing1( c(M1, M2), G[1])}
		else  if (length(G)==4) {Rep_2_6(M1, M2, c(G[1], G[2], G[3], G[4])); 
			if (length(S1)==2) Sister2( N1, S1[1], S1[2]) else if  (length(S2)==2)  Sister2( N2, S2[1], S2[2]) else {Sister1( N1, S1[1]); Sister1( N2, S2[1])}}
		else if(length(S1)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1))
			if (length(S2)==2) Sister2( N2, S2[1], S2[2]) else if  (length(G)==2)  Rep_2_4(M1, M2, c(G[1], G[2])) else {Sister1( N2, S2[1]); SisterOrSing1( c(M1, M2), G[1])}}
		else if(length(S2)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3], S2[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2))
			if (length(S1)==2) Sister2( N1, S1[1], S1[2]) else if  (length(G)==2)  Rep_2_4(M1, M2, c(G[1], G[2])) else {Sister1( N1, S1[1]); SisterOrSing1( c(M1, M2), G[1])}}
		else  if (length(G)==3) {Rep_2_5(M1, M2,c(G[1], G[2], G[3]))
			 if (length(S1)==3)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1))}
			else if (length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2))}
			else if (length(S1)==2) {Sister2( N1, S1[1], S1[2]);  Sister1( N2, S2[1])} else  {Sister2( N2, S2[1], S2[2]);  Sister1( N1, S1[1])}}
		else if (length(S1)==3)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1))
			 if (length(S2)==3)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2))}
			else if (length(G)==2) {Rep_2_4(M1, M2, c(G[1], G[2]));  Sister1( N2, S2[1])} else  {Sister2( N2, S2[1], S2[2]);  SisterOrSing1( c(M1, M2), G[1])}}
		else if (length(S2)==3)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2))
			 if (length(G)==2) {Rep_2_4(M1, M2, c(G[1], G[2]));  Sister1( N1, S1[1])} else  {Sister2( N1, S1[1], S1[2]);  SisterOrSing1( c(M1, M2), G[1])}}
		else {Rep_2_4(M1, M2, c(G[1], G[2])); Sister2( N1, S1[1], S1[2]); Sister2( N2, S2[1], S2[2])}}
	else {cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6]) ,c(sample.int(4,6, replace=T)))->>SU; S1<-SU[,1][SU[,2]==1]; S2<-SU[,1][SU[,2]==2]; S3<-SU[,1][SU[,2]==3]; S4<-SU[,1][SU[,2]==4]
		if(length(S1)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))}		
		else if(length(S2)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5], S2[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}		
		else if(length(S3)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4], S3[5], S3[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}		
		else if(length(S4)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(Inc4, S4[1], S4[2], S4[3], S4[4], S4[5], S4[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))}	
		else if(length(S1)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4], S1[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if (length(S2)==1) Sister1( Inc2,  S2[1]) else if  (length(S3)==1) Sister1( Inc3,  S3[1]) else Sister1( Inc4,  S4[1])}
		else if(length(S2)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4], S2[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			if (length(S1)==1) Sister1( Inc1,  S1[1]) else if  (length(S3)==1) Sister1( Inc3,  S3[1]) else Sister1( Inc4,  S4[1])}
		else if(length(S3)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4], S3[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if (length(S1)==1) Sister1( Inc1,  S1[1]) else if  (length(S2)==1) Sister1( Inc2,  S2[1]) else  Sister1( Inc4,  S4[1])}
		else if(length(S4)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(Inc4, S4[1], S4[2], S4[3], S4[4], S4[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))
			if (length(S1)==1) Sister1( Inc1,  S1[1]) else if  (length(S2)==1) Sister1( Inc2,  S2[1]) else Sister1( Inc3,  S3[1])}
		else if(length(S1)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if (length(S2)==2) Sister2( Inc2, S2[1], S2[2]) else if (length(S3)==2) Sister2(  Inc3, S3[1], S3[2]) else if (length(S4)==2) Sister2(  Inc4, S4[1], S4[2])
			else if (length(S2)==0) {Sister1 (PHYLO, Inc3, S3[1]); Sister1 (PHYLO, Inc4, S4[1])} else if (length(S3)==0) {Sister1 (PHYLO, Inc2, S2[1]); Sister1 (PHYLO, Inc4, S4[1])} else {Sister1 (PHYLO, Inc2, S2[1]); Sister1 (PHYLO, Inc3, S3[1])}}
		else if(length(S2)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3], S2[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			if (length(S1)==2) Sister2( Inc1, S1[1], S1[2]) else if (length(S3)==2) Sister2(  Inc3, S3[1], S3[2]) else if (length(S4)==2) Sister2(  Inc4, S4[1], S4[2])
			else if (length(S1)==0) {Sister1 (PHYLO, Inc3, S3[1]); Sister1 (PHYLO, Inc4, S4[1])} else if (length(S3)==0) {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc4, S4[1])} else {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc3, S3[1])}}
		else if(length(S3)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3], S3[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if (length(S1)==2) Sister2( Inc1, S1[1], S1[2]) else if (length(S2)==2) Sister2(  Inc2, S2[1], S2[2]) else if (length(S4)==2) Sister2(  Inc4, S4[1], S4[2])
			else if (length(S1)==0) {Sister1 (PHYLO, Inc2, S2[1]); Sister1 (PHYLO, Inc4, S4[1])} else if (length(S2)==0) {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc4, S4[1])} else {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc2, S2[1])}}
		else if(length(S4)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(Inc4, S4[1], S4[2], S4[3], S4[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))
			if (length(S1)==2) Sister2( Inc1, S1[1], S1[2]) else if (length(S2)==2) Sister2(  Inc2, S2[1], S2[2]) else if (length(S3)==2) Sister2(  Inc3, S3[1], S3[2])
			else if (length(S1)==0) {Sister1 (PHYLO, Inc2, S2[1]); Sister1 (PHYLO, Inc3, S3[1])} else if (length(S2)==0) {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc3, S3[1])} else {Sister1 (PHYLO, Inc1, S1[1]); Sister1 (PHYLO, Inc2, S2[1])}}
		else if(length(S1)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc1))
			if (length(S2)==3) {St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))}
			else if(length(S3)==3) {St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}
			else if(length(S4)==3) {St[3]<-list(c(Inc4, S4[1], S4[2], S4[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))}
			else if(length(S2)==2) {Sister2(  Inc2, S2[1], S2[2]); if (length(S3)==1) Sister1(  Inc3, S3[1]) else Sister1(  Inc4, S4[1])}
  			else if(length(S3)==2) {Sister2(  Inc3, S3[1], S3[2]); if (length(S2)==1) Sister1(  Inc2, S2[1]) else  Sister1(  Inc4, S4[1])}
  			else if(length(S4)==2) {Sister2(  Inc4, S4[1], S4[2]); if (length(S2)==1) Sister1(  Inc2, S2[1]) else  Sister1(  Inc3, S3[1])}
			else { Sister1(  Inc2, S2[1]);  Sister1(  Inc3, S3[1]); Sister1(  Inc4, S4[1])}}
		else if(length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc2))
			if (length(S3)==3) {St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))}
			else if(length(S4)==3) {St[3]<-list(c(Inc4, S4[1], S4[2], S4[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))}
			else if(length(S1)==2) {Sister2(  Inc1, S1[1], S1[2]); if (length(S3)==1) Sister1(  Inc3, S3[1]) else Sister1(  Inc4, S4[1])}
  			else if(length(S3)==2) {Sister2(  Inc3, S3[1], S3[2]); if (length(S1)==1) Sister1(  Inc1, S1[1]) else  Sister1(  Inc4, S4[1])}
  			else if(length(S4)==2) {Sister2(  Inc4, S4[1], S4[2]); if (length(S1)==1) Sister1(  Inc1, S1[1]) else  Sister1(  Inc3, S3[1])}
			else { Sister1(  Inc1, S1[1]);  Sister1(  Inc3, S3[1]); Sister1(  Inc4, S4[1])}}
		else if(length(S3)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc3, S3[1], S3[2], S3[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc3))
			if (length(S4)==3) {St[3]<-list(c(Inc4, S4[1], S4[2], S4[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))}
			else if(length(S1)==2) {Sister2(  Inc1, S1[1], S1[2]); if (length(S2)==1) Sister1(  Inc2, S2[1]) else Sister1(  Inc4, S4[1])}
  			else if(length(S2)==2) {Sister2(  Inc2, S2[1], S2[2]); if (length(S1)==1) Sister1(  Inc1, S1[1]) else  Sister1(  Inc4, S4[1])}
  			else if(length(S4)==2) {Sister2(  Inc4, S4[1], S4[2]); if (length(S1)==1) Sister1(  Inc1, S1[1]) else  Sister1(  Inc2, S2[1])}
			else { Sister1(  Inc1, S1[1]);  Sister1(  Inc2, S2[1]); Sister1(  Inc4, S4[1])}}
		else if(length(S4)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(Inc4, S4[1], S4[2], S4[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))
			if (length(S1)==2) {Sister2(  Inc1, S1[1], S1[2]); if (length(S2)==1) Sister1(  Inc2, S2[1]) else Sister1(  Inc3, S3[1])}
  			else if(length(S2)==2) {Sister2(  Inc2, S2[1], S2[2]); if (length(S1)==1) Sister1(  Inc1, S1[1]) else  Sister1(  Inc3, S3[1])}
  			else if(length(S3)==2) {Sister2(  Inc3, S3[1], S3[2]); if (length(S1)==1) Sister1(  Inc1, S1[1]) else  Sister1(  Inc2, S2[1])}
			else { Sister1(  Inc1, S1[1]);  Sister1(  Inc2, S2[1]); Sister1(  Inc3, S3[1])}}
		else if(length(S1)==0) {Sister2(  Inc2, S2[1], S2[2]); Sister2(  Inc3, S3[1], S3[2]); Sister2(  Inc4, S4[1], S4[2])}
		else if(length(S2)==0) {Sister2(  Inc1, S1[1], S1[2]); Sister2(  Inc3, S3[1], S3[2]); Sister2(  Inc4, S4[1], S4[2])}
		else if(length(S3)==0) {Sister2(  Inc1, S1[1], S1[2]); Sister2(  Inc2, S2[1], S2[2]); Sister2(  Inc4, S4[1], S4[2])}
		else if(length(S4)==0) {Sister2(  Inc1, S1[1], S1[2]); Sister2(  Inc2, S2[1], S2[2]); Sister2(  Inc3, S3[1], S3[2])}
		else if(length(S1)==2) {Sister2(  Inc1, S1[1], S1[2]); if (length(S2)==2) {Sister2(  Inc2, S2[1], S2[2]); Sister1(  Inc3, S3[1]); Sister1(  Inc4, S4[1])}
			else if  (length(S3)==2) {Sister2(  Inc3, S3[1], S3[2]); Sister1(  Inc2, S2[1]); Sister1(  Inc4, S4[1])} else {Sister2(  Inc4, S4[1], S4[2]); Sister1(  Inc2, S2[1]); Sister1(  Inc3, S3[1])}}
		else if(length(S2)==2) {Sister2(  Inc2, S2[1], S2[2]); if (length(S3)==2) {Sister2(  Inc3, S3[1], S3[2]); Sister1(  Inc1, S1[1]); Sister1(  Inc4, S4[1])}
			else {Sister2(  Inc4, S4[1], S4[2]); Sister1(  Inc1, S1[1]); Sister1(  Inc3, S3[1])}}
		else {Sister2(  Inc3, S3[1], S3[2]); Sister2(  Inc4, S4[1], S4[2]); Sister1(  Inc1, S1[1]); Sister1(  Inc2, S2[1])}}
plot(PHYLO)}

Rep_4_11_Part<-function  (Inc1, Inc2, Inc3, Inc4, Missings) {
	 if (is.monophyletic(PHYLO, c(Inc1, Inc2, Inc3, Inc4 ))==T) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1, Tip9:1, Tip10:1, Tip11:1);") ; St[3]<-list(c(Inc1,Inc2, Inc3,  Inc4, Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6], Missings[7]));PHYLO<<-drop.tip(PHYLO, Inc1) ;PHYLO<<-drop.tip(PHYLO, Inc2) ; PHYLO<<-drop.tip(PHYLO, Inc3) ; PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), Inc4))} 
	else  if (is.monophyletic(PHYLO, c(Inc2, Inc3, Inc1))==T||is.monophyletic(PHYLO, c(Inc1, Inc2, Inc4))==T||is.monophyletic(PHYLO, c(Inc1, Inc3, Inc4))==T||is.monophyletic(PHYLO, c(Inc2, Inc3, Inc4))==T)  
		{cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6], Missings[7]) ,c(sample.int(2,7, replace=T, prob = c(1,3))))->>SU; Sam<-SU[,1][SU[,2]==2]; Unsam<-SU[,1][SU[,2]==1]
		if (is.monophyletic(PHYLO, c(Inc1, Inc2, Inc3))==T) {Inc1->Mo1; Inc2->Mo2; Inc3->Mo3; Inc4->>NM} else if  (is.monophyletic(PHYLO, c(Inc1, Inc2, Inc4))==T) {Inc1->Mo1; Inc2->Mo2; Inc4->Mo3; Inc3->NM}  else if (is.monophyletic(PHYLO, c(Inc1, Inc3, Inc4))==T) {Inc1->Mo1; Inc3->Mo2; Inc4->Mo3; Inc2->NM} else {Inc2->Mo1; Inc3->Mo2; Inc4->Mo3; Inc1->NM}
		{if(length(Sam)==0)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5], Unsam[6], Unsam[7])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM))}
		else if(length(Sam)==1) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5], Unsam[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), NM)); SisterOrSing1( c(Mo1, Mo2, Mo3), Sam[1])}
		else if(length(Sam)==2) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5]));  Start<-c(Mo1, Mo2, Mo3); MIS<-c(Sam[1], Sam[2]); MIS1<-MIS[sample.int(2, 1)]; SisterOrSing1(Start, MIS1); MIS<-MIS[MIS%in%MIS1==F]; Start<-c(Start, MIS1); SisterOrSing1(Start, MIS)} 
		else if(length(Sam)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3], Unsam[4]));  Rep_3_6(Mo1, Mo2, Mo3, c(Sam[1], Sam[2], Sam[3]))}
		else if(length(Sam)==4) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(NM, Unsam[1], Unsam[2], Unsam[3]));  Rep_3_7(Mo1, Mo2, Mo3, c(Sam[1], Sam[2], Sam[3], Sam[4]))}
		else if(length(Sam)==5) {Sister2( NM,  Unsam[1], Unsam[2]);   Rep_3_8(Mo1, Mo2, Mo3, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5]))}
		else if(length(Sam)==6) {Sister1( NM, Unsam[1]); Rep_3_9(Mo1, Mo2, Mo3, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5], Sam[6]))} else Rep_3_10 (Mo1, Mo2, Mo3, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5], Sam[6], Sam[7]))}}
	else if (is.monophyletic(PHYLO, c(Inc1, Inc2))==T&is.monophyletic(PHYLO, c(Inc3, Inc4))==T||is.monophyletic(PHYLO, c(Inc1, Inc3))==T&is.monophyletic(PHYLO, c(Inc2, Inc4))==T||is.monophyletic(PHYLO, c(Inc1, Inc4))==T&is.monophyletic(PHYLO, c(Inc2, Inc3))==T) 
		{{if (is.monophyletic(PHYLO, c(Inc1, Inc2))==T&is.monophyletic(PHYLO, c(Inc3, Inc4))==T) {Inc1->M11; Inc2->M12; Inc3->M21; Inc4->M22} else if (is.monophyletic(PHYLO, c(Inc1, Inc3))==T&is.monophyletic(PHYLO, c(Inc2, Inc4))==T)  {Inc1->M11; Inc3->M12; Inc2->M21; Inc4->M22}  else {Inc1->M11; Inc4->M12; Inc2->M21; Inc3->M22}}
		cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6], Missings[7]) ,c(sample.int(2,7, replace=T)))->>SU; Sam<-SU[,1][SU[,2]==2]; Unsam<-SU[,1][SU[,2]==1];
		if(length(Sam)==0) Rep_2_9(M21, M22, c(Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5], Unsam[6], Unsam[7]))
		else if (length(Sam)==7) Rep_2_9(M11, M12, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5], Sam[6], Sam[7]))
		else if (length(Sam)==1) {Rep_2_8(M21, M22, c(Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5], Unsam[6])); SisterOrSing1( c(M11, M12), Sam[1])}
		else if (length(Sam)==6) {Rep_2_8(M11, M12, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5], Sam[6])); SisterOrSing1(c(M21, M22), Unsam[1])}
		else if (length(Sam)==5) {Rep_2_7(M11, M12, c(Sam[1], Sam[2], Sam[3], Sam[4], Sam[5])); Rep_2_4(M21, M22, c(Unsam[1], Unsam[2]))}
		else if (length(Sam)==2) {Rep_2_7(M21, M22, c(Unsam[1], Unsam[2], Unsam[3], Unsam[4], Unsam[5])); Rep_2_4(M11, M12, c(Sam[1], Sam[2]))}
		else if (length(Sam)==4) {Rep_2_6(M11, M12, c(Sam[1], Sam[2], Sam[3], Sam[4])); Rep_2_5(M21, M22, c(Unsam[1], Unsam[2], UnSam[3]))}
		else {Rep_2_6(M21, M22, c(Unsam[1], Unsam[2], Unsam[3], Unsam[4])); Rep_2_5(M11, M12, c(Sam[1], Sam[2], Sam[3]))}}
	else if (is.monophyletic(PHYLO, c(Inc1, Inc2))==T||is.monophyletic(PHYLO, c(Inc1, Inc3))==T||is.monophyletic(PHYLO, c(Inc1, Inc4))==T||is.monophyletic(PHYLO, c(Inc2, Inc3))==T||is.monophyletic(PHYLO, c(Inc2, Inc4))==T||is.monophyletic(PHYLO, c(Inc3, Inc4))==T)
		{{if (is.monophyletic(PHYLO, c(Inc1, Inc2))==T) {Inc1->M1; Inc2->M2; Inc3->N1; Inc4->N2} else if (is.monophyletic(PHYLO, c(Inc1, Inc3))==T)  {Inc1->M1; Inc3->M2; Inc2->N1; Inc4->N2} else if (is.monophyletic(PHYLO, c(Inc1, Inc4))==T)  {Inc1->M1; Inc4->M2; Inc2->N1; Inc3->N2}
		 else if (is.monophyletic(PHYLO, c(Inc2, Inc3))==T)  {Inc2->M1; Inc3->M2; Inc1->N1; Inc4->N2} else if (is.monophyletic(PHYLO, c(Inc2, Inc4))==T)  {Inc2->M1; Inc4->M2; Inc1->N1; Inc3->N2} else  {Inc3->M1; Inc4->M2; Inc1->N1; Inc4->N2}}
		cbind(c(Missings[1], Missings[2], Missings[3], Missings[4], Missings[5], Missings[6]) ,c(sample.int(3,6, prob=c(1,1,2), replace=T)))->>SU; S1<-SU[,1][SU[,2]==1]; S2<-SU[,1][SU[,2]==2]; G<-SU[,1][SU[,2]==3]
		if(length(G)==7) Rep_2_9(M1, M2, c(G[1], G[2], G[3], G[4], G[5], G[6], G[7]))
		else  if(length(S1)==7) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6], S1[7])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1))}
		else  if(length(S2)==7) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1, Tip8:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3], S2[4], S2[5], S2[6], S1[7])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2))}
		else  if(length(G)==6) {Rep_2_8(M1, M2, c(G[1], G[2], G[3], G[4], G[5], G[6]));
			if (length(S1)==1) Sister1( N1, S1[1]) else  Sister1( N2, S2[1]) }
		else  if(length(S1)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3], S1[4], S1[5], S1[6])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1));
			if (length(S2)==1) Sister1( N2, S2[1]) else SisterOrSing1( c(M1, M2), G[1])}
		else  if(length(S2)==6) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1, Tip7:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3], S2[4], S2[5], S1[7])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2));
			if (length(S1)==1) Sister1( N1, S1[1]) else SisterOrSing1( c(M1, M2), G[1])}
		else  if (length(G)==5) {Rep_2_7(M1, M2, c(G[1], G[2], G[3], G[4], G[5])); 
			if (length(S1)==2) Sister2( N1, S1[1], S1[2]) else if  (length(S2)==2)  Sister2( N2, S2[1], S2[2]) else {Sister1( N1, S1[1]); Sister1( N2, S2[1])}}
		else if(length(S1)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3], S1[4], S1[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1))
			if (length(S2)==2) Sister2( N2, S2[1], S2[2]) else if  (length(G)==2)  Rep_2_4(M1, M2, c(G[1], G[2])) else {Sister1( N2, S2[1]); SisterOrSing1( c(M1, M2), G[1])}}
		else if(length(S2)==5) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1, Tip6:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3], S2[4], S2[5])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2))
			if (length(S1)==2) Sister2( N1, S1[1], S1[2]) else if  (length(G)==2)  Rep_2_4(M1, M2, c(G[1], G[2])) else {Sister1( N1, S1[1]); SisterOrSing1( c(M1, M2), G[1])}}
		else  if (length(G)==4) {Rep_2_6(M1, M2, c(G[1], G[2], G[3], G[4]))
			 if (length(S1)==3)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1))}
			else if (length(S2)==3) {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2))}
			else if (length(S1)==2) {Sister2( N1, S1[1], S1[2]);  Sister1( N2, S2[1])} else  {Sister2( N2, S2[1], S2[2]);  Sister1( N1, S1[1])}}
		else if (length(S1)==4)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3], S1[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1))
			if (length(G)==3) Rep_2_5(M1, M2, c(G[1], G[2], G[3]))
			else if (length(S2)==3)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2))}
			else if (length(G)==2) {Rep_2_4(M1, M2, c(G[1], G[2]));  Sister1( N2, S2[1])} else  {Sister2( N2, S2[1], S2[2]);  SisterOrSing1( c(M1, M2), G[1])}}
		else if (length(S2)==4)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1, Tip5:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3], S2[4])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2))
			if (length(G)==3) Rep_2_5(M1, M2, c(G[1], G[2], G[3]))
			 if (length(S1)==3)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1))}
			 if (length(G)==2) {Rep_2_4(M1, M2, c(G[1], G[2]));  Sister1( N1, S1[1])} else  {Sister2( N1, S1[1], S1[2]);  SisterOrSing1( c(M1, M2), G[1])}}
		else  if (length(G)==3) {Rep_2_5(M1, M2, c(G[1], G[2], G[3])); Sister2( N1, S1[1], S1[2]); Sister2( N2, S2[1], S2[2])}
		else if (length(S1)==3)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(N1, S1[1], S1[2], S1[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N1)); Rep_2_4(M1, M2, c(G[1], G[2])); Sister2( N2, S2[1], S2[2])}
		else if (length(S2)==3)  {St<-read.tree(text="(Tip1:1,Tip2:1, Tip3:1, Tip4:1);") ; St[3]<-list(c(N2, S2[1], S2[2], S2[3])); PHYLO<<-bind.tree(PHYLO, St, getNode(phylo4(PHYLO), N2)); Rep_2_4(M1, M2, c(G[1], G[2])); Sister2( N1, S1[1], S1[2])}}
	else print("ERROR THIS NOT DONE")
plot(PHYLO)}



