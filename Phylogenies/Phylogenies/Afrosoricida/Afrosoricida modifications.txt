################################################################################################################################################################
###########################################################Chrysochloridae######################################################################################
################################################################################################################################################################

#One of the trees of the family from the posterior distribution
Chrysochloridae<-read.tree(text="((((Chrysochloris_asiatica:1,Chrysochloris_stuhlmanni:1):1,Cryptochloris_wintoni:1):1,Eremitalpa_granti:1):1,(((((Amblysomus_robustus:1,Amblysomus_septentrionalis:1):1,((Amblysomus_hottentotus:1,Amblysomus_marleyi:1):1,Amblysomus_corriae:1):1):1,(Carpitalpa_arendsi:1,(Neamblysomus_gunningi:1,Neamblysomus_julianae:1):1):1):1,(Chlorotalpa_duthieae:1,Chlorotalpa_sclateri:1):1):1,((Calcochloris_leucorhinus:1,Calcochloris_obtusirostris:1):1,(Chrysospalax_trevelyani:1,Chrysospalax_villosus:1):1):1):1);")
PHYLO<-Chrysochloridae

#Place Calcochloris_tytonis based on Nature 446, 507-512 (2007)
Sister1("Calcochloris_leucorhinus", "Calcochloris_tytonis")
#Place Chrysochloris_visagiei based on Nature 446, 507-512 (2007)
SisterOrSing1(c("Chrysochloris_asiatica", "Chrysochloris_stuhlmanni"), "Chrysochloris_visagiei")
#Place Cryptochloris_zyli based on taxonomy
Sister1("Cryptochloris_wintoni", "Cryptochloris_zyli")
 
#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 12 MYA following Meredith et al (2011)
BD.gen(12.04,0.904)
PHYLO->Chrysochloridae


################################################################################################################################################################
###########################################################Tenrecidae###########################################################################################
################################################################################################################################################################

#One of the trees of the family from the posterior distribution
Tenrecidae<-read.tree(text="((((Setifer_setosus:1,Echinops_telfairi:1):1,(Tenrec_ecaudatus:1,Hemicentetes_semispinosus:1):1):1,(Geogale_aurita:1,(Oryzorictes_hova:1,(Limnogale_mergulus:1,Microgale_brevicaudata:1):1):1):1):1,(Potamogale_velox:1,Micropotamogale_lamottei:1):1);")
PHYLO<-Tenrecidae

#Place Oryzorictes_tetradactylus based on taxonomy
Sister1("Oryzorictes_hova", "Oryzorictes_tetradactylus")
#Place Micropotamogale_ruwenzorii based on taxonomy
Sister1("Micropotamogale_lamottei", "Micropotamogale_ruwenzorii")
#Place Hemicentetes_nigriceps based on taxonomy
Sister1("Hemicentetes_semispinosus", "Hemicentetes_nigriceps")
#Set the genus Microgale as a big unresolved polytomi
TR<-read.tree(text="(Microgale_brevicaudata:1, Microgale_cowani:1, Microgale_dobsoni:1, Microgale_drouhardi:1, Microgale_dryas:1, Microgale_fotsifotsy:1, Microgale_gracilis:1, Microgale_gymnorhyncha:1, Microgale_jenkinsae:1, Microgale_jobihely :1, Microgale_longicaudata:1, Microgale_macpheei:1, Microgale_majori:1, Microgale_monticola:1, Microgale_nasoloi:1, Microgale_parvula:1, Microgale_principula:1, Microgale_pusilla:1, Microgale_soricoides:1, Microgale_taiva:1, Microgale_talazaci:1, Microgale_thomasi:1):1;")
PHYLO<<-bind.tree(PHYLO, TR ,  getNode(phylo4(PHYLO), "Microgale_brevicaudata"))

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 47 MYA following Meredith et al (2011)
BD.gen(47,0.904)
PHYLO->Tenrecidae

################################################################################################################################################################
###########################################################The interfamily relationship#########################################################################
################################################################################################################################################################

#The relationsnip between the families in the order
Afrosoricida<-read.tree(text="(Tenrecidae:21.21, Chrysochloridae:56.17);")

#Adding the families one by one
Afrosoricida<-bind.tree(Afrosoricida, Chrysochloridae, getNode(phylo4(Afrosoricida),"Chrysochloridae"))
Afrosoricida<-bind.tree(Afrosoricida, Tenrecidae, getNode(phylo4(Afrosoricida),"Tenrecidae"))
is.ultrametric(Afrosoricida)
write.tree(Afrosoricida, "Afrosoricida.nex")

Afrosoricida