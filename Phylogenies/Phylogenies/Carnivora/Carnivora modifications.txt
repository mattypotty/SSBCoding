################################################################################################################################################################
###############################################################Canidae##########################################################################################
################################################################################################################################################################

#One of the trees of the family from the posterior distribution
Canidae<-read.tree(text="(((Urocyon_cinereoargenteus:1,Urocyon_littoralis:1):1,((((Canis_lupus:1,((Canis_latrans:1,Canis_simensis:1):1,Canis_aureus:1):1):1,(Lycaon_pictus:1,Cuon_alpinus:1):1):1,(Canis_adustus:1,Canis_mesomelas:1):1):1,(((Atelocynus_microtis:1,Cerdocyon_thous:1):1,(Pseudalopex_culpaeus:1,((Pseudalopex_griseus:1,Pseudalopex_gymnocercus:1):1,(Pseudalopex_fulvipes:1,(Pseudalopex_sechurae:1,Pseudalopex_vetulus:1):1):1):1):1):1,((Dusicyon_australis:1,Chrysocyon_brachyurus:1):1,Speothos_venaticus:1):1):1):1):1,(((Vulpes_zerda:1,Vulpes_cana:1):1,(((Vulpes_vulpes:1,Vulpes_rueppellii:1):1,Vulpes_corsac:1):1,(Vulpes_chama:1,(Alopex_lagopus:1,Vulpes_macrotis:1):1):1):1):1,(Nyctereutes_procyonoides:1,Otocyon_megalotis:1):1):1);")
PHYLO<-Canidae

#Place Canis_dirus based on Bulletin of the American Museum of Natural History 325: 1-218 (2009)
Sister1("Canis_lupus", "Canis_dirus")
#Place Canis_rufus based on uncertainty of species status
Sister1("Canis_lupus", "Canis_rufus")
#Place Cynotherium_sardous based on Comptes Rendus Palevol 2 (8): 695–702
SisterOrSing1(c("Cuon_alpinus", "Lycaon_pictus"), "Cynotherium_sardous")
#Place missing species of Vulpes based on Nature 446, 507-512 (2007) and BMC Biology 10:12 (2012)
Sister2("Vulpes_corsac",  "Vulpes_bengalensis",  "Vulpes_ferrilata")
SisterAnd1(c("Vulpes_macrotis", "Alopex_lagopus"),"Vulpes_velox")
Sister1("Vulpes_chama",  "Vulpes_pallida")
#Place Dusicyon_avus based on taxonomy
Sister1( "Dusicyon_australis", "Dusicyon_avus")
#Place the two extinct genera Protocyon and Theriodictis as sisters to one of the genera of south american cenids
Start<-c("Atelocynus_microtis", "Cerdocyon_thous", "Chrysocyon_brachyurus", list(c("Dusicyon_australis", "Dusicyon_avus")), "Speothos_venaticus", list(c("Pseudalopex_culpaeus", "Pseudalopex_fulvipes", "Pseudalopex_griseus", "Pseudalopex_gymnocercus", "Pseudalopex_sechurae", "Pseudalopex_vetulus")))
MIS<-c("Protocyon_troglodytes", "Theriodictis_tarijensis")
MIS1<-MIS[sample.int(2, 1)]; SisterOrSing1(Start, MIS1); MIS<-MIS[MIS%in%MIS1==F]; Start<-c(Start, MIS1)
SisterOrSing1(Start, MIS)

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 16.3 MYA following Nyakatura and Bininda-Emonds (2012)
BD.gen(16.3,0.685)
PHYLO->Canidae

################################################################################################################################################################
###############################################################Eupleridae#######################################################################################
################################################################################################################################################################

#One of the trees of the family from the posterior distribution
Eupleridae<-read.tree(text="((Fossa_fossana:1,Eupleres_goudotii:1):1,(Cryptoprocta_ferox:1,(((Salanoia_concolor:1,Mungotictis_decemlineata:1):1,Galidictis_fasciata:1):1,Galidia_elegans:1):1):1);")
PHYLO<-Eupleridae

#Place Cryptoprocta_spelea based on taxonomy
Sister1("Cryptoprocta_ferox", "Cryptoprocta_spelea")
#Place Galidictis_grandidieri based on taxonomy
Sister1("Galidictis_fasciata", "Galidictis_grandidieri")

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 18 MYA following Nyakatura and Bininda-Emonds (2012)
BD.gen(18,0.685)
PHYLO->Eupleridae


################################################################################################################################################################
##################################################################Felidae#######################################################################################
################################################################################################################################################################

#One of the trees of the family from the posterior distribution
Felidae<-read.tree(text="(((((((Prionailurus_rubiginosus:1,((Prionailurus_viverrinus:1,Prionailurus_bengalensis:1):1,Prionailurus_planiceps:1):1):1,(Otocolobus_manul:1,(Felis_chaus:1,((Felis_margarita:1,Felis_silvestris:1):1,Felis_nigripes:1):1):1):1):1,(((Puma_yagouaroundi:1,Puma_concolor:1):1,Acinonyx_jubatus:1):1,(Lynx_rufus:1,(Lynx_pardinus:1,(Lynx_canadensis:1,Lynx_lynx:1):1):1):1):1):1,((Leopardus_wiedii:1,Leopardus_pardalis:1):1,((Leopardus_colocolo:1,Leopardus_jacobita:1):1,((Leopardus_guigna:1,Leopardus_geoffroyi:1):1,Leopardus_tigrinus:1):1):1):1):1,(Pardofelis_marmorata:1,(Pardofelis_temminckii:1,Pardofelis_badia:1):1):1):1,(Leptailurus_serval:1,(Caracal_caracal:1,Caracal_aurata
:1):1):1):1,(((Panthera_uncia:1,Panthera_tigris:1):1,(Panthera_pardus:1,(Panthera_leo:1,Panthera_onca:1):1):1):1,Neofelis_nebulosa:1):1);")
PHYLO<-Felidae

#Place the Homotherium and Smilidon as sister to rest of the family based on Current Biology 15: R589-R590 (2005)
TR<-read.tree(text="(((Homotherium_latidens:1, Homotherium_serum:1):1, (Smilodon_fatalis:1, Smilodon_populator:1):1):1, A:1);")
PHYLO<<-bind.tree(TR, PHYLO ,  getNode(phylo4(TR),"A"))
#Place Panthera_atrox and Panthera_spelaea based on Molecular Ecology 18: 1668-1677 (2009)
TR<-read.tree(text="((Panthera_spelaea:1, Panthera_atrox:1):1,Panthera_leo:1):1;")
PHYLO<<-bind.tree(PHYLO, TR , getNode(phylo4(PHYLO),"Panthera_leo"))
#Place Neofelis_diardi based on taxonomy
Sister1("Neofelis_nebulosa", "Neofelis_diardi")
#Place Miracinonyx_trumani as sister to the genus Puma based on Current Biology 15: R589-R590 (2005)
SisterAnd1(c("Puma_concolor", "Puma_yagouaroundi"), "Miracinonyx_trumani")
#Place Leopardus_amnicola as sister to Leopardus_wiedii following Geological Society of America Abstracts with Programs  38: 63 (2006)
Sister1("Leopardus_wiedii", "Leopardus_amnicola")

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 28 MYA following Rincon et al  (2011)
BD.gen(28,0.685)
PHYLO->Felidae


################################################################################################################################################################
##################################################################Herpestidae###################################################################################
################################################################################################################################################################

#One of the trees of the family from the posterior distribution
Herpestidae<-read.tree(text="((Liberiictis_kuhni:1,(Mungos_mungo:1,(Suricata_suricatta:1,((Helogale_parvula:1,Helogale_hirtula:1):1,Crossarchus_obscurus:1):1):1):1):1,(((((Paracynictis_selousi:1,Cynictis_penicillata:1):1,((Bdeogale_crassicauda:1,Bdeogale_nigripes:1):1,Rhynchogale_melleri:1):1):1,Ichneumia_albicauda:1):1,(Atilax_paludinosus:1,((Herpestes_brachyurus:1,((Herpestes_edwardsii:1,Herpestes_javanicus:1):1,Herpestes_fuscus:1):1):1,Herpestes_naso:1):1):1):1,(Herpestes_sanguineus:1,(Herpestes_ichneumon:1,Herpestes_pulverulentus:1):1):1):1);")
PHYLO<-Herpestidae
#One of the trees for the genus Herpestes from the posterior distribution
Herpestes<-read.tree(text="(((Herpestes_sanguineus:1,(Herpestes_ichneumon:1,Herpestes_pulverulentus:1):1):1,((((Herpestes_javanicus:1,Herpestes_edwardsii:1):1,Herpestes_fuscus:1):1,(Herpestes_smithii:1,Herpestes_vitticollis:1):1):1,(Herpestes_brachyurus:1,Herpestes_urva:1):1):1):1,Herpestes_naso:1);")
#One of the trees for the genus Herpestes from the posterior distribution
MONOP.GROUP<-c("Herpestes_brachyurus", "Herpestes_edwardsii", "Herpestes_fuscus", "Herpestes_ichneumon", "Herpestes_javanicus", "Herpestes_naso", "Herpestes_pulverulentus", "Herpestes_sanguineus", "Herpestes_smithii", "Herpestes_urva", "Herpestes_vitticollis")
#Merging the family tree with the tree for Herpestes
Replace.groups(Herpestes, MONOP.GROUP)

#Add a species at the root of the phylogeny of the tree to handle problems with running some functions on root branches (this will later be deleted)
TR<-read.tree(text="(A:1, B:1);")
PHYLO<<-bind.tree(TR , PHYLO,  1)
#Place Mungos_gambianus based on taxonomy
Sister1("Mungos_mungo", "Mungos_gambianus")
#Place missing species of the genus Crossarchus based on BMC Biology 10:12 (2012)
Sister2("Crossarchus_obscurus", "Crossarchus_alexandri", "Crossarchus_ansorgei")
Sister1("Crossarchus_obscurus", "Crossarchus_platycephalus")
#Place missing species of the genus Herpestes based on BMC Biology 10:12 (2012)
SisterOrSing1(c("Herpestes_edwardsii", "Herpestes_fuscus", "Herpestes_javanicus","Herpestes_smithii"), "Herpestes_semitorquatus")
SisterOrSing1(c("Herpestes_pulverulentus", "Herpestes_sanguineus"), "Herpestes_flavescens")
Sister1("Herpestes_sanguineus", "Herpestes_ochraceus")
#Place missing species of the genus Bdeogale based on BMC Biology 10:12 (2012)
Sister1( "Bdeogale_nigripes", "Bdeogale_jacksoni")
Sister1( "Bdeogale_crassicauda",  "Bdeogale_omnivora")
#Place Dologale_dybowskii as sister to Helogale based on BMC Biology 10:12 (2012)
SisterAnd1( c("Helogale_hirtula", "Helogale_parvula"),  "Dologale_dybowskii")

#Remove the added species again
PHYLO<<-drop.tip(PHYLO, "B")

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 11.6 MYA following Nyakatura and Bininda-Emonds (2012)
BD.gen(11.6,0.685)
PHYLO->Herpestidae

################################################################################################################################################################
##################################################################Hyanidae######################################################################################
################################################################################################################################################################

#One of the trees of the family from the posterior distribution
Hyanidae<-read.tree(text="(((Hyaena_hyaena:1,Hyaena_brunnea:1):1,Proteles_cristata:1):1,Crocuta_crocuta:1);")
PHYLO<-Hyanidae

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 5.3 MYA following Nyakatura and Bininda-Emonds (2012)
BD.gen(5.3,0.685)
PHYLO->Hyanidae

################################################################################################################################################################
##################################################################Mephitidae####################################################################################
################################################################################################################################################################
#One of the trees of the family from the posterior distribution
Mephitidae<-read.tree(text="((Conepatus_chinga:1,(Spilogale_putorius:1,Mephitis_mephitis:1):1):1,Mydaus_marchei:1);")
PHYLO<-Mephitidae

#Place Mephitis_macroura based on taxonomy
Sister1("Mephitis_mephitis", "Mephitis_macroura")
#Place Mydaus_javanensis based on taxonomy
Sister1("Mydaus_marchei", "Mydaus_javanensis")
#Place missing species of Spilogale based on BMC Biology 10:12 (2012)
Sister2("Spilogale_putorius", "Spilogale_gracilis", "Spilogale_pygmaea")
Sister1("Spilogale_putorius", "Spilogale_angustifrons")
#Place missing species of Conepatus based on BMC Biology 10:12 (2012)
TR<-read.tree(text="((Conepatus_chinga:1,Conepatus_leuconotus:1):1,(Conepatus_humboldtii:1,Conepatus_semistriatus:1):1):1;")
PHYLO<<-bind.tree(PHYLO, TR , getNode(phylo4(PHYLO),"Conepatus_chinga"))
#Place the extinct genus Brachyprotoma as sister to one of the extant genera in the family
SisterOrSing1(c(list(c("Conepatus_chinga", "Conepatus_leuconotus", "Conepatus_semistriatus", "Conepatus_humboldtii")), list(c("Spilogale_putorius", "Spilogale_angustifrons","Spilogale_gracilis", "Spilogale_pygmaea")), list(c("Mephitis_mephitis", "Mephitis_macroura")), list(c("Mydaus_marchei", "Mydaus_javanensis"))), "Brachyprotoma_obtusata")

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 20.7 MYA following Nyakatura and Bininda-Emonds (2012)
BD.gen(20.7,0.685)
PHYLO->Mephitidae


################################################################################################################################################################
##################################################################Mustelidae####################################################################################
################################################################################################################################################################
#One of the trees of the family from the posterior distribution
Mustelidae<-read.tree(text="(Taxidea_taxus:1,(Mellivora_capensis:1,((((Eira_barbara:1,Martes_pennanti:1):1,(Gulo_gulo:1,(Martes_flavigula:1,(Martes_foina:1,((Martes_zibellina:1,(Martes_martes:1,Martes_americana:1):1):1,Martes_melampus:1):1):1):1):1):1,(((((((((Lutra_lutra:1,Lutra_sumatrana:1):1,((Aonyx_cinerea:1,Lutrogale_perspicillata:1):1,Aonyx_capensis:1):1):1,Enhydra_lutris:1):1,Lutra_maculicollis:1):1,((Lontra_felina:1,Lontra_longicaudis:1):1,Lontra_canadensis:1):1):1,Pteronura_brasiliensis:1):1,(((Mustela_nudipes:1,Mustela_strigidorsa:1):1,(Mustela_kathiah:1,(Mustela_erminea:1,((((((Mustela_putorius:1,Mustela_eversmanii:1):1,Mustela_nigripes:1):1,Mustela_itatsi:1):1,Mustela_sibirica:1):1,Mustela_lutreolina:1):1,(Mustela_nivalis:1,Mustela_altaica:1):1):1):1):1):1,(Neovison_vison:1,Mustela_frenata:1):1):1):1,(((Galictis_vittata:1,Galictis_cuja:1):1,Lyncodon_patagonicus:1):1,(Vormela_peregusna:1,((Ictonyx_striatus:1,Poecilogale_albinucha:1):1,Ictonyx_libyca:1):1):1):1):1,(Melogale_personata:1,Melogale_moschata:1):1):1):1,((Meles_meles:1,Meles_anakuma:1):1,Arctonyx_collaris:1):1):1):1);")
PHYLO<-Mustelidae
#One of the trees for the genus Lontra from the posterior distribution
Lontra<-read.tree(text="((Lontra_longicaudis:1,(Lontra_provocax:1,Lontra_felina:1):1):1,Lontra_canadensis:1);")
MONOP.GROUP<-c("Lontra_canadensis", "Lontra_felina", "Lontra_longicaudis", "Lontra_provocax")
#Merging the family tree with the tree for Lontra
Replace.groups(Lontra, MONOP.GROUP)
#One of the trees for the genus Meles from the posterior distribution
Meles<-read.tree(text="((Meles_leucurus:1,Meles_anakuma:1):1,Meles_meles:1);")
MONOP.GROUP<-c("Meles_anakuma", "Meles_leucurus", "Meles_meles")
#Merging the family tree with the tree for Meles
Replace.groups(Meles, MONOP.GROUP)
#One of the trees for the genus Mustela from the posterior distribution
Mustela<-read.tree(text="(((((Mustela_itatsi:1,(Mustela_sibirica:1,(Mustela_nigripes:1,(Mustela_eversmanii:1,(Mustela_lutreolina:1,Mustela_putorius:1):1):1):1):1):1,(Mustela_altaica:1,Mustela_nivalis:1):1):1,Mustela_erminea:1):1,(Mustela_nudipes:1,Mustela_strigidorsa:1):1):1,((Mustela_frenata:1,(Mustela_africana:1,Mustela_felipei:1):1):1,Neovison_vison:1):1);")
MONOP.GROUP<-c("Mustela_altaica", "Mustela_erminea", "Mustela_eversmanii", "Mustela_frenata", "Mustela_itatsi", "Mustela_kathiah", "Mustela_lutreolina", "Mustela_nigripes", "Mustela_nivalis", "Mustela_nudipes", "Mustela_putorius", "Mustela_sibirica", "Mustela_strigidorsa", "Mustela_africana", "Mustela_felipei")
#Merging the family tree with the tree for Mustela
Replace.groups(Mustela, MONOP.GROUP)

#Place Aonyx_congicus based on BMC Biology 10:12 (2012)
Sister1("Aonyx_capensis", "Aonyx_congicus")
#Place missing species of Mustela based on BMC Biology 10:12 (2012)
Sister1("Mustela_nivalis", "Mustela_subpalmata")
SisterOrSing1(c(list(c("Mustela_eversmanii", "Mustela_putorius")), "Mustela_lutreolina", "Mustela_nigripes", list(c("Mustela_nudipes", "Mustela_strigidorsa")), "Mustela_sibirica"), "Mustela_lutreola")
#Place missing species of Martes based on BMC Biology 10:12 (2012)
Sister1("Martes_flavigula", "Martes_gwatkinsii")
#Place Neovison_macrodon based on taxonomy
Sister1("Neovison_vison", "Neovison_macrodon")
#Place missing species of Melogale based on taxonomy
Rep_2_4("Melogale_moschata", "Melogale_personata", c("Melogale_everetti", "Melogale_orientalis"))

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 25.8 MYA following Nyakatura and Bininda-Emonds (2012)
BD.gen(25.8,0.685)
PHYLO->Mustelidae

################################################################################################################################################################
##################################################################Otariidae#####################################################################################
################################################################################################################################################################
#One of the trees of the family from the posterior distribution
Otariidae<-read.tree(text="(Callorhinus_ursinus:1,(Neophoca_cinerea:1,(((Arctocephalus_tropicalis:1,Arctocephalus_pusillus:1):1,(((Arctocephalus_australis:1,Arctocephalus_forsteri:1):1,Arctocephalus_gazella:1):1,(Otaria_flavescens:1,Phocarctos_hookeri:1):1):1):1,(Eumetopias_jubatus:1,Zalophus_californianus:1):1):1):1);")
PHYLO<-Otariidae
#One of the trees for the genus Arctocephalus from the posterior distribution
Arctocephalus<-read.tree(text="((((Arctocephalus_townsendi:1,Arctocephalus_philippii:1):1,Arctocephalus_gazella:1):1,((Arctocephalus_galapagoensis:1,Arctocephalus_forsteri:1):1,Arctocephalus_australis:1):1):1,(Arctocephalus_pusillus:1,Arctocephalus_tropicalis:1):1);")
MONOP.GROUP<-c("Arctocephalus_australis", "Arctocephalus_forsteri", "Arctocephalus_galapagoensis", "Arctocephalus_gazella", "Arctocephalus_philippii", "Arctocephalus_pusillus", "Arctocephalus_townsendi", "Arctocephalus_tropicalis")
#Merging the family tree with the tree for Arctocephalus
Replace.groups(Arctocephalus, MONOP.GROUP)

#Place missing species of Zalophus based on BMC Biology 10:12 (2012)
TR<-read.tree(text="((Zalophus_californianus:1, Zalophus_wollebaeki:1):1,Zalophus_japonicus:1):1;")
PHYLO<<-bind.tree(PHYLO, TR , getNode(phylo4(PHYLO),"Zalophus_californianus"))

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 8.1 MYA following Nyakatura and Bininda-Emonds (2012)
BD.gen(8.1,0.685)
PHYLO->Otariidae

################################################################################################################################################################
##################################################################Phocidae######################################################################################
################################################################################################################################################################
#One of the trees of the family from the posterior distribution
Phocidae<-read.tree(text="(((((Histriophoca_fasciata:1,Pagophilus_groenlandicus:1):1,((Phoca_vitulina:1,Phoca_largha:1):1,((Pusa_hispida:1,(Pusa_caspica:1,Pusa_sibirica:1):1):1,Halichoerus_grypus:1):1):1):1,Cystophora_cristata:1):1,Erignathus_barbatus:1):1,((Monachus_monachus:1,Monachus_schauinslandi:1):1,(Mirounga_angustirostris:1,(((Leptonychotes_weddellii:1,Hydrurga_leptonyx:1):1,Lobodon_carcinophaga:1):1,Ommatophoca_rossii:1):1):1):1);")
PHYLO<-Phocidae

#Place Mirounga_leonina based on taxonomy
Sister1("Mirounga_angustirostris", "Mirounga_leonina")
#Place Monachus_tropicalis based on BMC Biology 10:12 (2012)
Sister1("Monachus_schauinslandi", "Monachus_tropicalis")

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 15.3 MYA following Nyakatura and Bininda-Emonds (2012)
BD.gen(15.3,0.685)
PHYLO->Phocidae

################################################################################################################################################################
##################################################################Procyonidae###################################################################################
################################################################################################################################################################
#One of the trees of the family from the posterior distribution
Procyonidae<-read.tree(text="((((Bassariscus_astutus:1,Bassariscus_sumichrasti:1):1,(Procyon_cancrivorus:1,Procyon_lotor:1):1):1,(((Nasua_narica:1,Nasuella_olivacea:1):1,Nasua_nasua:1):1,(Bassaricyon_alleni:1,Bassaricyon_gabbii:1):1):1):1,Potos_flavus:1);")
PHYLO<-Procyonidae

#Place Procyon_pygmaeus based on BMC Biology 10:12 (2012)
SisterAnd1(c("Procyon_lotor", "Procyon_cancrivorus"), "Procyon_pygmaeus" )
#Place missing species of Bassaricyon based on taxonomy
Rep_2_5("Bassaricyon_alleni", "Bassaricyon_gabbii",  c("Bassaricyon_beddardi", "Bassaricyon_lasius", "Bassaricyon_pauli"))

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 24 MYA following Nyakatura and Bininda-Emonds (2012)
BD.gen(24,0.685)
PHYLO->Procyonidae

################################################################################################################################################################
##################################################################Ursidae#####################################################################################
################################################################################################################################################################
#One of the trees of the family from the posterior distribution
Ursidae<-read.tree(text="((Tremarctos_ornatus:1,((Ursus_thibetanus:1,((Ursus_maritimus:1,Ursus_arctos:1):1,Ursus_americanus:1):1):1,(Helarctos_malayanus:1,Melursus_ursinus:1):1):1):1,Ailuropoda_melanoleuca:1);")
PHYLO<-Ursidae
#One of the trees for the genus Ursus from the posterior distribution
Ursus<-read.tree(text="((Ursus_spelaeus:1,(Ursus_maritimus:1,Ursus_arctos:1):1):1,(Ursus_americanus:1,Ursus_thibetanus:1):1);")
MONOP.GROUP<-c("Ursus_americanus", "Ursus_arctos", "Ursus_maritimus", "Ursus_spelaeus", "Ursus_thibetanus")
#Merging the family tree with the tree for Ursus
Replace.groups(Ursus, MONOP.GROUP)

#Place the extinct species in the subfamily Tremarctinae assuming genus monophyly but no additional resolution
Sister2("Tremarctos_ornatus", "Arctodus_simus", "Arctotherium_tarijense")
Sister1("Arctotherium_tarijense", "Arctotherium_wingei")
Sister1("Tremarctos_ornatus", "Tremarctos_floridanus")

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 17.2 MYA following Nyakatura and Bininda-Emonds (2012)
BD.gen(17.2,0.685)
PHYLO->Ursidae

################################################################################################################################################################
##################################################################Viverridae#####################################################################################
################################################################################################################################################################
#One of the trees of the family from the posterior distribution
Viverridae<-read.tree(text="(((Viverricula_indica:1,((Viverra_tangalunga:1,(Viverra_zibetha:1,Viverra_megaspila:1):1):1,Civettictis_civetta:1):1):1,(Poiana_richardsonii:1,(Genetta_thierryi:1,(((Genetta_tigrina:1,(Genetta_maculata:1,Genetta_pardina:1):1):1,Genetta_genetta:1):1,(Genetta_servalina:1,Genetta_johnstoni:1):1):1):1):1):1,((Arctogalidia_trivirgata:1,((Paguma_larvata:1,(Paradoxurus_hermaphroditus:1,Paradoxurus_jerdoni:1):1):1,Arctictis_binturong:1):1):1,(Cynogale_bennettii:1,(Hemigalus_derbyanus:1,Chrotogale_owstoni:1):1):1):1);")
PHYLO<-Viverridae
#One of the trees for the genus Genetta from the posterior distribution
Genetta<-read.tree(text="((((Genetta_johnstoni:1,Genetta_piscivora:1):1,(Genetta_genetta:1,((Genetta_angolensis:1,((Genetta_bourloni:1,(Genetta_pardina:1,Genetta_poensis:1):1):1,Genetta_maculata:1):1):1,Genetta_tigrina:1):1):1):1,(Genetta_thierryi:1,Genetta_cristata:1):1):1,(Genetta_servalina:1,Genetta_victoriae:1):1);")
MONOP.GROUP<-c("Genetta_genetta", "Genetta_johnstoni", "Genetta_maculata", "Genetta_pardina", "Genetta_servalina", "Genetta_thierryi", "Genetta_tigrina", "Genetta_angolensis", "Genetta_bourloni", "Genetta_cristata", "Genetta_piscivora", "Genetta_poensis", "Genetta_victoriae")
#Merging the family tree with the tree for Genetta
Replace.groups(Genetta, MONOP.GROUP)
#One of the trees for the genus Paradoxurus from the posterior distribution
Paradoxurus<-read.tree(text="((Paradoxurus_jerdoni:1,Paradoxurus_zeylonensis:1):1,Paradoxurus_hermaphroditus:1);")
MONOP.GROUP<-c("Paradoxurus_hermaphroditus", "Paradoxurus_jerdoni", "Paradoxurus_zeylonensis")
#Merging the family tree with the tree for Paradoxurus
Replace.groups(Paradoxurus, MONOP.GROUP)

#Place Poiana_leightoni based on taxonomy
Sister1("Poiana_richardsonii", "Poiana_leightoni")
#Place Viverra_civettina based on BMC Biology 10:12 (2012)
Sister1("Viverra_megaspila", "Viverra_civettina")
#Place Macrogalidia_musschenbroekii based on BMC Biology 10:12 (2012)
SisterAnd1(c("Paradoxurus_jerdoni", "Paradoxurus_zeylonensis","Paradoxurus_hermaphroditus"), "Macrogalidia_musschenbroekii")
#Place Diplogale_hosei based on BMC Biology 10:12 (2012)
Sister1("Hemigalus_derbyanus", "Diplogale_hosei")
#Place Genetta_abyssinica based on BMC Biology 10:12 (2012)
Sister1("Genetta_thierryi", "Genetta_abyssinica")

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 23.6 MYA following Nyakatura and Bininda-Emonds (2012)
BD.gen(23.6,0.685)
PHYLO->Viverridae

################################################################################################################################################################
###########################################################The interfamily relationship#########################################################################
################################################################################################################################################################

#The relationsnip between the families in the order. Families with one or two species are already added
Carnivora<-read.tree(text="((((((Eupleridae:3.67, Herpestidae:10.07):4.58, Hyanidae:20.95):5.56, Viverridae:8.21):0.98, ((Prionodon_pardicolor:10.9, Prionodon_linsang:10.9):18.55, Felidae:1.45):3.34):6.87, Nandinia_binotata:39.66):15.01, (Canidae:30.19, ((((Mustelidae:3, Procyonidae:4.8):2.25, Ailurus_fulgens:31.05):1, Mephitidae:11.35):6.6, (((Odobenus_rosmarus:14.69, Otariidae:6.59):6.65, Phocidae:6.04):15.47, Ursidae:19.61):1.84):7.84):8.18);")   

#Adding the families one by one
Carnivora<-bind.tree(Carnivora, Canidae, getNode(phylo4(Carnivora),"Canidae"))
Carnivora<-bind.tree(Carnivora, Eupleridae, getNode(phylo4(Carnivora),"Eupleridae"))
Carnivora<-bind.tree(Carnivora, Felidae, getNode(phylo4(Carnivora),"Felidae"))
Carnivora<-bind.tree(Carnivora, Herpestidae, getNode(phylo4(Carnivora),"Herpestidae"))
Carnivora<-bind.tree(Carnivora, Hyanidae, getNode(phylo4(Carnivora),"Hyanidae"))
Carnivora<-bind.tree(Carnivora, Mephitidae, getNode(phylo4(Carnivora),"Mephitidae"))
Carnivora<-bind.tree(Carnivora, Mustelidae, getNode(phylo4(Carnivora),"Mustelidae"))
Carnivora<-bind.tree(Carnivora, Otariidae, getNode(phylo4(Carnivora),"Otariidae"))
Carnivora<-bind.tree(Carnivora, Phocidae, getNode(phylo4(Carnivora),"Phocidae"))
Carnivora<-bind.tree(Carnivora, Procyonidae, getNode(phylo4(Carnivora),"Procyonidae"))
Carnivora<-bind.tree(Carnivora, Ursidae, getNode(phylo4(Carnivora),"Ursidae"))
Carnivora<-bind.tree(Carnivora, Viverridae, getNode(phylo4(Carnivora),"Viverridae"))
is.ultrametric(Carnivora)

write.tree(Carnivora, "Carnivora.nex")