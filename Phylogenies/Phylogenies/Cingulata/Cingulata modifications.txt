################################################################################################################################################################
###########################################################Cingulata############################################################################################
################################################################################################################################################################

#One of the trees of the family from the posterior distribution of Dasypodidae (the only extant family)
Cingulata<-read.tree(text="((((Chlamyphorus_truncatus:1,Chlamyphorus_retusus:1):1,((Cabassous_unicinctus:1,Tolypeutes_tricinctus:1):1,Priodontes_maximus:1):1):1,(Euphractus_sexcinctus:1,(Zaedyus_pichiy:1,Chaetophractus_vellerosus:1):1):1):1,(Dasypus_kappleri:1,Dasypus_novemcinctus:1):1);")
PHYLO<-Cingulata
#Place missing species of Dasypus based on taxonomy
Rep_2_8("Dasypus_kappleri", "Dasypus_novemcinctus", c("Dasypus_hybridus", "Dasypus_pilosus", "Dasypus_sabanicola", "Dasypus_septemcinctus", "Dasypus_yepesi", "Dasypus_bellus"))
#Place Tolypeutes_matacus based on taxonomy
Sister1("Tolypeutes_tricinctus", "Tolypeutes_matacus")
#Place missing species of Cabassous based on taxonomy
TR<-read.tree(text="(Cabassous_centralis:1, Cabassous_chacoensis:1, Cabassous_tatouay:1, Cabassous_unicinctus:1):1;")
PHYLO<<-bind.tree(PHYLO, TR ,  getNode(phylo4(PHYLO),"Cabassous_unicinctus"))
#Place missing species of Chaetophractus based on taxonomy
Sister2("Chaetophractus_vellerosus", "Chaetophractus_nationi", "Chaetophractus_villosus")
#Place Clyptodontidae and Pampatheridae following Journal of Vertebrate Paleontology 29: 881-893 (2009)
SisterAnd1(c("Dasypus_kappleri", "Dasypus_novemcinctus", "Dasypus_hybridus", "Dasypus_pilosus", "Dasypus_sabanicola", "Dasypus_septemcinctus", "Dasypus_yepesi", "Dasypus_bellus"), "Glyptodon_clavipes")
TR<-read.tree(text="((((Glyptodon_clavipes:1, Glyptodon_reticulatus:1):1,Doedicurus_clavicaudatus:1):1, (Neosclerocalyptus_paskoenis:1, Panochthus_tuberculatus:1):1):1, ((Pampatherium_humboldti:1, Pampatherium_typum:1):1, Holmesina _septentrionalis:1):1):1;")
PHYLO<<-bind.tree(PHYLO, TR ,  getNode(phylo4(PHYLO),"Glyptodon_clavipes"))
Sister2("Holmesina_septentrionalis", "Holmesina_occidentalis", "Holmesina_paulacoutoi")
Start<-c(list(c("Glyptodon_clavipes", "Glyptodon_reticulatus")), "Doedicurus_clavicaudatus", "Neosclerocalyptus_paskoenis", "Panochthus_tuberculatus")
MIS<-c("Glyptotherium_cylindricum", "Hoplophorus_euphractus", "Neuryurus_trabeculatus")
MIS1<-MIS[sample.int(3, 1)]; SisterOrSing1(Start, MIS1); MIS<-MIS[MIS%in%MIS1==F]; Start<-c(Start, MIS1)
MIS1<-MIS[sample.int(2, 1)]; SisterOrSing1(Start, MIS1); MIS<-MIS[MIS%in%MIS1==F]; Start<-c(Start, MIS1)
SisterOrSing1(Start, MIS)
PHYLO<-read.tree(text=write.tree(PHYLO))
Sister1("Glyptotherium_cylindricum", "Glyptotherium_floridanum")
#Place  Propraopus as sister to Dasypus based on subfamily. Note that this command needs to be executed after the placement of gluptodonts and pampatheres
SisterAnd1(c("Dasypus_kappleri", "Dasypus_novemcinctus", "Dasypus_hybridus", "Dasypus_pilosus", "Dasypus_sabanicola", "Dasypus_septemcinctus", "Dasypus_yepesi", "Dasypus_bellus"), "Propraopus_sulcatus")
Sister1("Propraopus_sulcatus", "Propraopus_punctatus")
#Place Eutatus as sister to one of the extant genera of Euphractinae
SisterOrSing1(c("Chlamyphorus_retusus", list(c("Chaetophractus_vellerosus", "Chaetophractus_nationi", "Chaetophractus_villosus")), "Chlamyphorus_truncatus", "Euphractus_sexcinctus", "Zaedyus_pichiy"), "Eutatus_seguini")

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 40 MYA following Meredith et al (2011)
BD.gen(40,0.904)
PHYLO->Cingulata

################################################################################################################################################################
##########################################################Note that the order is identical to the family########################################################
################################################################################################################################################################

write.tree(Cingulata, "Cingulata.nex")