
################################################################################################################################################################
###########################################################Dasyuromorphia#######################################################################################
################################################################################################################################################################
#One of the trees of the order from the posterior distribution (all families were analysed together.
Dasyromorphia<-read.tree(text="(Thylacinus_cynocephalus:1,((((Planigale_maculata:1,(Planigale_gilesi:1,Planigale_tenuirostris:1):1):1,(((((Sminthopsis_aitkeni:1,Sminthopsis_griseoventer:1):1,(((((Sminthopsis_leucopus:1,Sminthopsis_murina:1):1,Sminthopsis_dolichura:1):1,(Sminthopsis_archeri:1,Sminthopsis_gilberti:1):1):1,Sminthopsis_ooldea:1):1,((Sminthopsis_hirtipes:1,Sminthopsis_psammophila:1):1,Sminthopsis_youngsoni:1):1):1):1,((Sminthopsis_longicaudata:1,((Ningaui_yvonneae:1,Ningaui_ridei:1):1,Ningaui_timealeyi:1):1):1,(Sminthopsis_crassicaudata:1,(((Sminthopsis_macroura:1,Sminthopsis_douglasi:1):1,Sminthopsis_bindi:1):1,Sminthopsis_virginiae:1):1):1):1):1,Sminthopsis_granulipes:1):1,Antechinomys_laniger:1):1):1,((Dasyuroides_byrnei:1,(Dasykaluta_rosamondae:1,((((Pseudantechinus_ningbing:1,(Pseudantechinus_macdonnellensis:1,Pseudantechinus_roryi:1):1):1,Pseudantechinus_woolleyae:1):1,Pseudantechinus_bilarni:1):1,((((Phascolosorex_dorsalis:1,Neophascogale_lorentzii:1):1,((((Dasyurus_albopunctatus:1,(Dasyurus_viverrinus:1,(Dasyurus_spartacus:1,Dasyurus_geoffroii:1):1):1):1,Dasyurus_maculatus:1):1,Dasyurus_hallucatus:1):1,Sarcophilus_harrisii:1):1):1,(Myoictis_melas:1,Parantechinus_apicalis:1):1):1,Dasycercus_cristicauda:1):1):1):1):1,((Phascogale_tapoatafa:1,Phascogale_calura:1):1,((((Murexia_longicaudata:1,Murexia_naso:1):1,Murexia_melanurus:1):1,(Murexia_habbema:1,Murexia_rothschildi:1):1):1,((Antechinus_swainsonii:1,Antechinus_minimus:1):1,(((Antechinus_flavipes:1,(Antechinus_leo:1,Antechinus_bellus:1):1):1,Antechinus_stuartii:1):1,Antechinus_godmani:1):1):1):1):1):1):1,Myrmecobius_fasciatus:1):1);")
PHYLO<-Dasyromorphia
#One of the trees for the genus Myoictis from the posterior distribution
Myoictis<-read.tree(text="(((Myoictis_wavicus:1,Myoictis_leucura:1):1,Myoictis_wallacei:1):1,Myoictis_melas:1);")
MONOP.GROUP<-c("Myoictis_leucura", "Myoictis_melas", "Myoictis_wallacei", "Myoictis_wavicus")
#Merging the family tree with the tree for Myoictis
Replace.groups(Myoictis, MONOP.GROUP)
#One of the trees for the genus Planigale from the posterior distribution
Planigale<-read.tree(text="((Planigale_ingrami:1,(Planigale_tenuirostris:1,Planigale_gilesi:1):1):1,(Planigale_novaeguineae:1,Planigale_maculata:1):1);")
MONOP.GROUP<-c("Planigale_gilesi", "Planigale_ingrami", "Planigale_maculata", "Planigale_novaeguineae", "Planigale_tenuirostris")
#Merging the family tree with the tree for Planigale
Replace.groups(Planigale, MONOP.GROUP)
#One of the trees for the genus Pseudantechinus from the posterior distribution
Pseudantechinus<-read.tree(text="((Pseudantechinus_woolleyae:1,Pseudantechinus_bilarni:1):1,(((Pseudantechinus_mimulus:1,Pseudantechinus_roryi:1):1,Pseudantechinus_macdonnellensis:1):1,Pseudantechinus_ningbing:1):1);")
MONOP.GROUP<-c("Pseudantechinus_bilarni", "Pseudantechinus_macdonnellensis", "Pseudantechinus_mimulus", "Pseudantechinus_ningbing", "Pseudantechinus_roryi", "Pseudantechinus_woolleyae")
#Merging the family tree with the tree for Pseudantechinus
Replace.groups(Pseudantechinus, MONOP.GROUP)
#One of the trees for the genus Sminthopsis from the posterior distribution
Sminthopsis<-read.tree(text="((((Sminthopsis_longicaudata:1,Sminthopsis_granulipes:1):1,(Sminthopsis_griseoventer:1,Sminthopsis_aitkeni:1):1):1,((Sminthopsis_ooldea:1,(Sminthopsis_archeri:1,((Sminthopsis_dolichura:1,Sminthopsis_leucopus:1):1,(Sminthopsis_gilberti:1,Sminthopsis_butleri:1):1):1):1):1,((Sminthopsis_hirtipes:1,Sminthopsis_youngsoni:1):1,Sminthopsis_psammophila:1):1):1):1,(((Sminthopsis_douglasi:1,Sminthopsis_virginiae:1):1,Sminthopsis_bindi:1):1,Sminthopsis_crassicaudata:1):1);")
MONOP.GROUP<-c("Sminthopsis_aitkeni", "Sminthopsis_archeri", "Sminthopsis_bindi", "Sminthopsis_crassicaudata", "Sminthopsis_dolichura", "Sminthopsis_douglasi", "Sminthopsis_gilberti", "Sminthopsis_granulipes", "Sminthopsis_griseoventer", "Sminthopsis_hirtipes", "Sminthopsis_leucopus", "Sminthopsis_longicaudata", "Sminthopsis_macroura", "Sminthopsis_murina", "Sminthopsis_ooldea", "Sminthopsis_psammophila", "Sminthopsis_virginiae", "Sminthopsis_youngsoni", "Sminthopsis_butleri")
#Merging the family tree with the tree for Sminthopsis
Replace.groups(Sminthopsis, MONOP.GROUP)

#Place Dasycercus_blythi based on taxonomy
Sister1( "Dasycercus_cristicauda", "Dasycercus_blythi")
#Place Phascolosorex_doriae based on taxonomy
Sister1( "Phascolosorex_dorsalis", "Phascolosorex_doriae")
#Place Phascogale_pirata based on Nature 446, 507-512 (2007)
Sister1("Phascogale_tapoatafa", "Phascogale_pirata")
#Place Antechinus_adustus based on Nature 446, 507-512 (2007)
Sister1("Antechinus_stuartii", 	"Antechinus_adustus")
#Place species of Antechinus not covered in Nature 446, 507-512 (2007) based on taxonomy
Start<-c("Antechinus_bellus", "Antechinus_flavipes", "Antechinus_godmani", "Antechinus_leo", "Antechinus_minimus", "Antechinus_stuartii", "Antechinus_swainsonii")
MIS<-c("Antechinus_agilis", "Antechinus_subtropicus")
MIS1<-MIS[sample.int(2, 1)]; SisterOrSing1(Start, MIS1); MIS<-MIS[MIS%in%MIS1==F]; Start<-c(Start, MIS1)
SisterOrSing1(Start, MIS)
#Place Sminthopsis_fuliginosus based on taxonomy
SisterOrSing1(c("Sminthopsis_aitkeni", "Sminthopsis_archeri", "Sminthopsis_bindi", "Sminthopsis_butleri", "Sminthopsis_crassicaudata", "Sminthopsis_dolichura", "Sminthopsis_douglasi", "Sminthopsis_gilberti", "Sminthopsis_granulipes", "Sminthopsis_griseoventer", "Sminthopsis_hirtipes", "Sminthopsis_leucopus", "Sminthopsis_longicaudata", "Sminthopsis_macroura", "Sminthopsis_murina", "Sminthopsis_ooldea", "Sminthopsis_psammophila", "Sminthopsis_virginiae", "Sminthopsis_youngsoni"), "Sminthopsis_fuliginosus")

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 30 MYA following Meredith et al (2011)
YULE.gen(30)
PHYLO->Dasyromorphia


################################################################################################################################################################
##########################################################Note that the order is identical to the family########################################################
################################################################################################################################################################

write.tree(Dasyromorphia, "Dasyromorphia.nex")


