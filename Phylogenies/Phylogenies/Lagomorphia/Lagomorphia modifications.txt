################################################################################################################################################################
################################################################Leporidae#######################################################################################
################################################################################################################################################################

#One of the trees of the family from the posterior distribution
Leporidae<-read.tree(text="((((((Romerolagus_diazi:1,((((Pronolagus_crassicaudatus:1,Pronolagus_randensis:1):1,Pronolagus_rupestris:1):1,Poelagus_marjorita:1):1,(Nesolagus_timminsi:1,Nesolagus_netscheri:1):1):1):1,(Lepus_americanus:1,(((Lepus_timidus:1,Lepus_townsendii:1):1,Lepus_saxatilis:1):1,(Lepus_californicus:1,Lepus_capensis:1):1):1):1):1,(((Sylvilagus_aquaticus:1,Sylvilagus_palustris:1):1,((Sylvilagus_obscurus:1,Sylvilagus_floridanus:1):1,(Sylvilagus_nuttallii:1,Sylvilagus_audubonii:1):1):1):1,Brachylagus_idahoensis:1):1):1,Pentalagus_furnessi:1):1,(Bunolagus_monticularis:1,Oryctolagus_cuniculus:1):1):1,Caprolagus_hispidus:1);")
PHYLO<-Leporidae
#One of the trees for the genus Lepus from the posterior distribution
Lepus<-read.tree(text="(Lepus_americanus:1,((Lepus_mandshuricus:1,Lepus_sinensis:1):1,(Lepus_brachyurus:1,(((Lepus_yarkandensis:1,(((Lepus_arcticus:1,((Lepus_timidus:1,(Lepus_castroviejoi:1,Lepus_coreanus:1):1):1,Lepus_othus:1):1):1,(Lepus_corsicanus:1,(Lepus_tolai:1,Lepus_capensis:1):1):1):1,Lepus_townsendii:1):1):1,((Lepus_hainanus:1,(Lepus_granatensis:1,Lepus_europaeus:1):1):1,(Lepus_oiostolus:1,Lepus_comus:1):1):1):1,(Lepus_saxatilis:1,(((Lepus_alleni:1,(Lepus_insularis:1,Lepus_californicus:1):1):1,Lepus_flavigularis:1):1,Lepus_callotis:1):1):1):1):1):1);")
MONOP.GROUP<-c("Lepus_americanus", "Lepus_californicus", "Lepus_capensis", "Lepus_saxatilis", "Lepus_timidus", "Lepus_townsendii", "Lepus_alleni", "Lepus_arcticus", "Lepus_brachyurus", "Lepus_callotis", "Lepus_castroviejoi", "Lepus_comus", "Lepus_coreanus", "Lepus_corsicanus", "Lepus_europaeus", "Lepus_flavigularis", "Lepus_granatensis", "Lepus_hainanus", "Lepus_insularis", "Lepus_mandshuricus", "Lepus_oiostolus", "Lepus_othus", "Lepus_sinensis", "Lepus_tolai", "Lepus_yarkandensis")
#Merging the family tree with the tree for Lepus
Replace.groups(Lepus, MONOP.GROUP)
#One of the trees for the genus Sylvilagus from the posterior distribution
Sylvilagus<-read.tree(text="(((Sylvilagus_robustus:1,Sylvilagus_floridanus:1):1,(Sylvilagus_obscurus:1,Sylvilagus_transitionalis:1):1):1,((Sylvilagus_aquaticus:1,Sylvilagus_palustris:1):1,(Sylvilagus_audubonii:1,Sylvilagus_nuttallii:1):1):1);")
MONOP.GROUP<-c("Sylvilagus_aquaticus", "Sylvilagus_audubonii", "Sylvilagus_floridanus", "Sylvilagus_nuttallii", "Sylvilagus_obscurus", "Sylvilagus_palustris", "Sylvilagus_robustus", "Sylvilagus_transitionalis")
#Merging the family tree with the tree for Sylvilagus
Replace.groups(Sylvilagus, MONOP.GROUP)

#Place Pronolagus_saundersiae as sister to Pronolagus_rupestris since the two species were formerly considered conspecific
Sister1("Pronolagus_rupestris", "Pronolagus_saundersiae")
#Place missing species of Lepus based on Nature 446, 507-512 (2007)
Sister1("Lepus_capensis", "Lepus_habessinicus")
Sister1("Lepus_saxatilis", "Lepus_microtis")
TR<-read.tree(text="((Lepus_nigricollis:1,Lepus_peguensis:1):1, Lepus_hainanus:1):1;")
PHYLO<<-bind.tree(PHYLO, TR ,  getNode(phylo4(PHYLO),"Lepus_hainanus"))
TR<-read.tree(text="((Lepus_tolai:1,Lepus_tibetanus:1):1, Lepus_starcki:1):1;")
PHYLO<<-bind.tree(PHYLO, TR ,  getNode(phylo4(PHYLO),"Lepus_tolai"))
SisterAnd1(c("Lepus_saxatilis", "Lepus_microtis"), "Lepus_fagani")
#Place missing speccies of Sylvilagus based on Nature 446, 507-512 (2007) and the subgenus Tapeti	
Rep_2_4("Sylvilagus_palustris", "Sylvilagus_aquaticus", c("Sylvilagus_insonus", "Sylvilagus_brasiliensis"))
Sister1("Sylvilagus_brasiliensis", "Sylvilagus_dicei")
SisterOrSing1 (c("Sylvilagus_floridanus", "Sylvilagus_robustus"), "Sylvilagus_cognatus")
SisterAnd1(c("Sylvilagus_floridanus", "Sylvilagus_robustus", "Sylvilagus_cognatus"),"Sylvilagus_cunicularius") 
Sister1("Sylvilagus_cunicularius", "Sylvilagus_graysoni")
SisterOrSing1(c("Sylvilagus_aquaticus",  "Sylvilagus_brasiliensis", "Sylvilagus_dicei", "Sylvilagus_palustris", "Sylvilagus_insonus"), "Sylvilagus_varynaensis")
SisterAnd1(c("Sylvilagus_brasiliensis", "Sylvilagus_cognatus", "Sylvilagus_cunicularius", "Sylvilagus_dicei", "Sylvilagus_floridanus", "Sylvilagus_graysoni", "Sylvilagus_insonus", "Sylvilagus_nuttallii", "Sylvilagus_obscurus", "Sylvilagus_palustris", "Sylvilagus_robustus", "Sylvilagus_transitionalis", "Sylvilagus_varynaensis"), "Sylvilagus_mansuetus")
Sister1("Sylvilagus_mansuetus", "Sylvilagus_bachmani")
#Place Aztlanolagus as sister to one og the extant genera of the family
SisterOrSing1(c(list(c("Lepus_alleni", "Lepus_americanus", "Lepus_arcticus", "Lepus_brachyurus", "Lepus_californicus", "Lepus_callotis", "Lepus_capensis", "Lepus_castroviejoi", "Lepus_comus", "Lepus_coreanus","Lepus_corsicanus", "Lepus_europaeus", "Lepus_fagani", "Lepus_flavigularis", "Lepus_granatensis", "Lepus_habessinicus", "Lepus_hainanus", "Lepus_insularis", "Lepus_mandshuricus", "Lepus_microtis",  "Lepus_nigricollis", "Lepus_oiostolus", "Lepus_othus", "Lepus_peguensis", "Lepus_saxatilis", "Lepus_sinensis", "Lepus_starcki", "Lepus_tibetanus", "Lepus_timidus", "Lepus_tolai", "Lepus_townsendii", "Lepus_yarkandensis")),
"Brachylagus_idahoensis", "Romerolagus_diazi", list(c("Sylvilagus_aquaticus", "Sylvilagus_audubonii", "Sylvilagus_bachmani", "Sylvilagus_brasiliensis",  "Sylvilagus_cognatus", "Sylvilagus_cunicularius", "Sylvilagus_dicei", "Sylvilagus_floridanus", "Sylvilagus_graysoni", "Sylvilagus_insonus",  "Sylvilagus_mansuetus", "Sylvilagus_nuttallii", "Sylvilagus_obscurus", "Sylvilagus_palustris", "Sylvilagus_robustus", "Sylvilagus_transitionalis", "Sylvilagus_varynaensis"))),  "Aztlanolagus_agilis")

#Simulate potential branch lengths wihtin the family based on MRCA of family equal to 15 MYA following Meredith et al (2011)
YULE.gen(15)
PHYLO->Leporidae

################################################################################################################################################################
################################################################Ochotonidae#####################################################################################
################################################################################################################################################################

#One of the trees of the family from the posterior distribution
Ochotonidae<-read.tree(text="(((Ochotona_gloveri:1,Ochotona_muliensis:1):1,Ochotona_erythrotis:1):1,((Ochotona_forresti:1,((Ochotona_rufescens:1,(Ochotona_ladacensis:1,(Ochotona_himalayana:1,((Ochotona_iliensis:1,Ochotona_koslowi:1):1,(Ochotona_roylei:1,Ochotona_macrotis:1):1):1):1):1):1,Ochotona_rutila:1):1):1,((((Ochotona_thomasi:1,((Ochotona_dauurica:1,Ochotona_thibetana:1):1,(Ochotona_cansus:1,(Ochotona_nubrica:1,Ochotona_curzoniae:1):1):1):1):1,Ochotona_pusilla:1):1,Ochotona_huangensis:1):1,((((Ochotona_turuchanensis:1,Ochotona_alpina:1):1,(Ochotona_hoffmanni:1,Ochotona_hyperborea:1):1):1,Ochotona_pallasi:1):1,(Ochotona_collaris:1,Ochotona_princeps:1):1):1):1):1);")
PHYLO<-Ochotonidae

#Place Prolagus as sister to Ochotona
TR<-read.tree(text="(Prolagus_sardus:1, A:1);")
PHYLO<<-bind.tree(TR, PHYLO ,  getNode(phylo4(TR),"A"))

#Place Ochotona_argentata and Ochotona_gaoligongensis based on Nature 446, 507-512 (2007)
Sister1("Ochotona_alpina", "Ochotona_argentata")
Sister1("Ochotona_forresti", "Ochotona_gaoligongensis")
#Place Ochotona_nigritia based on taxonomy (subgenus)
SisterOrSing1(c("Ochotona_erythrotis", "Ochotona_forresti", "Ochotona_gaoligongensis", "Ochotona_gloveri", "Ochotona_himalayana", "Ochotona_iliensis", "Ochotona_koslowi", "Ochotona_ladacensis", "Ochotona_macrotis", "Ochotona_muliensis", "Ochotona_roylei", "Ochotona_rutila"), "Ochotona_nigritia")
#Place Ochotona_whartoni based on taxonomy
SisterOrSing1(c("Ochotona_alpina","Ochotona_argentata","Ochotona_cansus","Ochotona_collaris","Ochotona_curzoniae","Ochotona_dauurica","Ochotona_erythrotis","Ochotona_forresti","Ochotona_gaoligongensis","Ochotona_gloveri","Ochotona_himalayana","Ochotona_hoffmanni","Ochotona_huangensis","Ochotona_hyperborea","Ochotona_iliensis","Ochotona_koslowi","Ochotona_ladacensis","Ochotona_macrotis","Ochotona_muliensis","Ochotona_nigritia","Ochotona_nubrica","Ochotona_pallasi","Ochotona_princeps","Ochotona_pusilla","Ochotona_roylei","Ochotona_rufescens","Ochotona_rutila","Ochotona_thibetana","Ochotona_thomasi","Ochotona_turuchanensis"),  "Ochotona_whartoni")

#Simulate potential branch lengths wihtin the family based on a divergence time with its closest relatives of 50.22 MYA following Meredith et al (2011)
#A node called Rootnode_Ochotonidae is temporarily added but will be deleted when the tree is combined with the remaining families in the order
PHYLO<-bind.tree(read.tree(text="(ROOT_1:1, Rootnode_Ochotonidae:1);"), PHYLO,1)
BD.gen(50.22,0.685)
PHYLO->Ochotonidae

################################################################################################################################################################
###########################################################The interfamily relationship#########################################################################
################################################################################################################################################################

#The relationsnip between the families in the order
Lagomorphia<-read.tree(text="(Ochotonidae:0, Leporidae:35.22);")

#Adding the families one by one
Lagomorphia<-bind.tree(Lagomorphia, Leporidae, getNode(phylo4(Lagomorphia),"Leporidae"))
Lagomorphia<-bind.tree(Lagomorphia, Ochotonidae, getNode(phylo4(Lagomorphia),"Ochotonidae"));Lagomorphia<-drop.tip(Lagomorphia, "Rootnode_Ochotonidae")

write.tree(Lagomorphia, "Lagomorphia.nex")





